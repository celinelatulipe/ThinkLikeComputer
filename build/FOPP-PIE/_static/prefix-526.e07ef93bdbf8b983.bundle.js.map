{"version":3,"file":"prefix-526.e07ef93bdbf8b983.bundle.js","mappings":"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","sources":["webpack://WebComponents/./runestone/fitb/js/fitb-i18n.en.js","webpack://WebComponents/./runestone/fitb/js/fitb-i18n.pt-br.js","webpack://WebComponents/./runestone/fitb/js/fitb.js","webpack://WebComponents/./runestone/fitb/js/timedfitb.js","webpack://WebComponents/./runestone/shortanswer/js/shortanswer.js","webpack://WebComponents/./runestone/shortanswer/js/timed_shortanswer.js","webpack://WebComponents/./runestone/timed/js/timed.js"],"sourcesContent":["$.i18n().load({\n    en: {\n        msg_no_answer: \"No answer provided.\",\n        msg_fitb_check_me: \"Check me\",\n        msg_fitb_compare_me: \"Compare me\",\n    },\n});\n","$.i18n().load({\n    \"pt-br\": {\n        msg_no_answer: \"Nenhuma resposta dada.\",\n        msg_fitb_check_me: \"Verificar\",\n        msg_fitb_compare_me: \"Comparar\"\n    },\n});\n","// *********\n// |docname|\n// *********\n// This file contains the JS for the Runestone fillintheblank component. It was created By Isaiah Mayerchak and Kirby Olson, 6/4/15 then revised by Brad Miller, 2/7/20.\n\"use strict\";\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport \"./fitb-i18n.en.js\";\nimport \"./fitb-i18n.pt-br.js\";\nimport \"../css/fitb.css\";\n\n// FITB constructor\nexport default class FITB extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        var orig = opts.orig; // entire <p> element\n        this.useRunestoneServices = opts.useRunestoneServices;\n        this.origElem = orig;\n        this.divid = orig.id;\n        this.correct = null;\n        // See comments in fitb.py for the format of ``feedbackArray`` (which is identical in both files).\n        //\n        // Find the script tag containing JSON and parse it. See `SO <https://stackoverflow.com/questions/9320427/best-practice-for-embedding-arbitrary-json-in-the-dom>`_. If this parses to ``false``, then no feedback is available; server-side grading will be performed.\n        this.feedbackArray = JSON.parse(\n            this.scriptSelector(this.origElem).html()\n        );\n        this.createFITBElement();\n        this.caption = \"Fill in the Blank\";\n        this.addCaption(\"runestone\");\n        this.checkServer(\"fillb\", true);\n        if (typeof Prism !== \"undefined\") {\n            Prism.highlightAllUnder(this.containerDiv);\n        }\n    }\n    // Find the script tag containing JSON in a given root DOM node.\n    scriptSelector(root_node) {\n        return $(root_node).find(`script[type=\"application/json\"]`);\n    }\n    /*===========================================\n    ====   Functions generating final HTML   ====\n    ===========================================*/\n    createFITBElement() {\n        this.renderFITBInput();\n        this.renderFITBButtons();\n        this.renderFITBFeedbackDiv();\n        // replaces the intermediate HTML for this component with the rendered HTML of this component\n        $(this.origElem).replaceWith(this.containerDiv);\n    }\n    renderFITBInput() {\n        // The text [input] elements are created by the template.\n        this.containerDiv = document.createElement(\"div\");\n        this.containerDiv.id = this.divid;\n        // Copy the original elements to the container holding what the user will see.\n        $(this.origElem).children().clone().appendTo(this.containerDiv);\n        // Remove the script tag.\n        this.scriptSelector(this.containerDiv).remove();\n        // Set the class for the text inputs, then store references to them.\n        let ba = $(this.containerDiv).find(\":input\");\n        ba.attr(\"class\", \"form form-control selectwidthauto\");\n        ba.attr(\"aria-label\", \"input area\");\n        this.blankArray = ba.toArray();\n        // When a blank is changed mark this component as interacted with.\n        // And set a class on the component in case we want to render components that have been used\n        // differently\n        for (let blank of this.blankArray) {\n            $(blank).change(this.recordAnswered.bind(this));\n        }\n    }\n\n    recordAnswered() {\n        this.isAnswered = true;\n        //let rcontainer = this.containerDiv.closest(\".runestone\");\n        //rcontainer.addClass(\"answered\");\n    }\n\n    renderFITBButtons() {\n        // \"submit\" button and \"compare me\" button\n        this.submitButton = document.createElement(\"button\");\n        this.submitButton.textContent = $.i18n(\"msg_fitb_check_me\");\n        $(this.submitButton).attr({\n            class: \"btn btn-success\",\n            name: \"do answer\",\n            type: \"button\",\n        });\n        this.submitButton.addEventListener(\n            \"click\",\n            function () {\n                this.checkCurrentAnswer();\n                this.logCurrentAnswer();\n            }.bind(this),\n            false\n        );\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(this.submitButton);\n        if (this.useRunestoneServices) {\n            this.compareButton = document.createElement(\"button\");\n            $(this.compareButton).attr({\n                class: \"btn btn-default\",\n                id: this.origElem.id + \"_bcomp\",\n                disabled: \"\",\n                name: \"compare\",\n            });\n            this.compareButton.textContent = $.i18n(\"msg_fitb_compare_me\");\n            this.compareButton.addEventListener(\n                \"click\",\n                function () {\n                    this.compareFITBAnswers();\n                }.bind(this),\n                false\n            );\n            this.containerDiv.appendChild(this.compareButton);\n        }\n        this.containerDiv.appendChild(document.createElement(\"div\"));\n    }\n    renderFITBFeedbackDiv() {\n        this.feedBackDiv = document.createElement(\"div\");\n        this.feedBackDiv.id = this.divid + \"_feedback\";\n        this.containerDiv.appendChild(document.createElement(\"br\"));\n        this.containerDiv.appendChild(this.feedBackDiv);\n    }\n    /*===================================\n    === Checking/loading from storage ===\n    ===================================*/\n    restoreAnswers(data) {\n        var arr;\n        // Restore answers from storage retrieval done in RunestoneBase.\n        try {\n            // The newer format encodes data as a JSON object.\n            arr = JSON.parse(data.answer);\n            // The result should be an array. If not, try comma parsing instead.\n            if (!Array.isArray(arr)) {\n                throw new Error();\n            }\n        } catch (err) {\n            // The old format didn't.\n            arr = data.answer.split(\",\");\n        }\n        for (var i = 0; i < this.blankArray.length; i++) {\n            $(this.blankArray[i]).attr(\"value\", arr[i]);\n        }\n        // Use the feedback from the server, or recompute it locally.\n        if (!this.feedbackArray) {\n            this.displayFeed = data.displayFeed;\n            this.correct = data.correct;\n            this.isCorrectArray = data.isCorrectArray;\n            // Only render if all the data is present; local storage might have old data missing some of these items.\n            if (\n                typeof this.displayFeed !== \"undefined\" &&\n                typeof this.correct !== \"undefined\" &&\n                typeof this.isCorrectArray !== \"undefined\"\n            ) {\n                this.renderFeedback();\n            }\n        } else {\n            this.checkCurrentAnswer();\n        }\n    }\n    checkLocalStorage() {\n        // Loads previous answers from local storage if they exist\n        var storedData;\n        if (this.graderactive) {\n            return;\n        }\n        var len = localStorage.length;\n        if (len > 0) {\n            var ex = localStorage.getItem(this.localStorageKey());\n            if (ex !== null) {\n                try {\n                    storedData = JSON.parse(ex);\n                    var arr = storedData.answer;\n                } catch (err) {\n                    // error while parsing; likely due to bad value stored in storage\n                    console.log(err.message);\n                    localStorage.removeItem(this.localStorageKey());\n                    return;\n                }\n                this.restoreAnswers(storedData);\n            }\n        }\n    }\n    setLocalStorage(data) {\n        let key = this.localStorageKey();\n        localStorage.setItem(key, JSON.stringify(data));\n    }\n\n    checkCurrentAnswer() {\n        // Start of the evaluation chain\n        this.isCorrectArray = [];\n        this.displayFeed = [];\n        this.given_arr = [];\n        for (var i = 0; i < this.blankArray.length; i++)\n            this.given_arr.push(this.blankArray[i].value);\n        if (this.useRunestoneServices) {\n            if (eBookConfig.enableCompareMe) {\n                this.enableCompareButton();\n            }\n        }\n        // Grade locally if we can't ask the server to grade.\n        if (this.feedbackArray) {\n            this.evaluateAnswers();\n            if (!this.isTimed) {\n                this.renderFeedback();\n            }\n        }\n    }\n\n    async logCurrentAnswer(sid) {\n        let answer = JSON.stringify(this.given_arr);\n        // Save the answer locally.\n        let feedback = true;\n        this.setLocalStorage({\n            answer: answer,\n            timestamp: new Date(),\n        });\n        let data = {\n            event: \"fillb\",\n            act: answer || \"\",\n            answer: answer || \"\",\n            correct: this.correct ? \"T\" : \"F\",\n            div_id: this.divid,\n        };\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n            feedback = false;\n        }\n        // Per `logBookEvent <logBookEvent>`, the result is undefined if there's no server. Otherwise, the server provides the endpoint-specific results in ``data.details``; see `make_json_response`.\n        data = await this.logBookEvent(data);\n        let detail = data && data.detail;\n        if (!feedback) return;\n        if (!this.feedbackArray) {\n            // On success, update the feedback from the server's grade.\n            this.setLocalStorage({\n                answer: answer,\n                timestamp: detail.timestamp,\n            });\n            this.correct = detail.correct;\n            this.displayFeed = detail.displayFeed;\n            this.isCorrectArray = detail.isCorrectArray;\n            if (!this.isTimed) {\n                this.renderFeedback();\n            }\n        }\n        return detail;\n    }\n\n    /*==============================\n    === Evaluation of answer and ===\n    ===     display feedback     ===\n    ==============================*/\n    // Inputs:\n    //\n    // - Strings entered by the student in ``this.blankArray[i].value``.\n    // - Feedback in ``this.feedbackArray``.\n    //\n    // Outputs:\n    //\n    // - ``this.displayFeed`` is an array of HTML feedback.\n    // - ``this.isCorrectArray`` is an array of true, false, or null (the question wasn't answered).\n    // - ``this.correct`` is true, false, or null (the question wasn't answered).\n    evaluateAnswers() {\n        // Keep track if all answers are correct or not.\n        this.correct = true;\n        for (var i = 0; i < this.blankArray.length; i++) {\n            var given = this.blankArray[i].value;\n            // If this blank is empty, provide no feedback for it.\n            if (given === \"\") {\n                this.isCorrectArray.push(null);\n                this.displayFeed.push($.i18n(\"msg_no_answer\"));\n                this.correct = false;\n            } else {\n                // Look through all feedback for this blank. The last element in the array always matches. If no feedback for this blank exists, use an empty list.\n                var fbl = this.feedbackArray[i] || [];\n                for (var j = 0; j < fbl.length; j++) {\n                    // The last item of feedback always matches.\n                    if (j === fbl.length - 1) {\n                        this.displayFeed.push(fbl[j][\"feedback\"]);\n                        break;\n                    }\n                    // If this is a regexp...\n                    if (\"regex\" in fbl[j]) {\n                        var patt = RegExp(\n                            fbl[j][\"regex\"],\n                            fbl[j][\"regexFlags\"]\n                        );\n                        if (patt.test(given)) {\n                            this.displayFeed.push(fbl[j][\"feedback\"]);\n                            break;\n                        }\n                    } else {\n                        // This is a number.\n                        console.assert(\"number\" in fbl[j]);\n                        var [min, max] = fbl[j][\"number\"];\n                        // Convert the given string to a number. While there are `lots of ways <https://coderwall.com/p/5tlhmw/converting-strings-to-number-in-javascript-pitfalls>`_ to do this; this version supports other bases (hex/binary/octal) as well as floats.\n                        var actual = +given;\n                        if (actual >= min && actual <= max) {\n                            this.displayFeed.push(fbl[j][\"feedback\"]);\n                            break;\n                        }\n                    }\n                }\n                // The answer is correct if it matched the first element in the array. A special case: if only one answer is provided, count it wrong; this is a misformed problem.\n                let is_correct = j === 0 && fbl.length > 1;\n                this.isCorrectArray.push(is_correct);\n                if (!is_correct) {\n                    this.correct = false;\n                }\n            }\n        }\n        this.percent =\n            this.isCorrectArray.filter(Boolean).length / this.blankArray.length;\n    }\n\n    renderFeedback() {\n        if (this.correct) {\n            $(this.feedBackDiv).attr(\"class\", \"alert alert-info\");\n            for (let j = 0; j < this.blankArray.length; j++) {\n                $(this.blankArray[j]).removeClass(\"input-validation-error\");\n            }\n        } else {\n            if (this.displayFeed === null) {\n                this.displayFeed = \"\";\n            }\n            for (let j = 0; j < this.blankArray.length; j++) {\n                if (this.isCorrectArray[j] !== true) {\n                    $(this.blankArray[j]).addClass(\"input-validation-error\");\n                } else {\n                    $(this.blankArray[j]).removeClass(\"input-validation-error\");\n                }\n            }\n            $(this.feedBackDiv).attr(\"class\", \"alert alert-danger\");\n        }\n        var feedback_html = \"<ul>\";\n        for (var i = 0; i < this.displayFeed.length; i++) {\n            feedback_html += \"<li>\" + this.displayFeed[i] + \"</li>\";\n        }\n        feedback_html += \"</ul>\";\n        // Remove the list if it's just one element.\n        if (this.displayFeed.length == 1) {\n            feedback_html = feedback_html.slice(\n                \"<ul><li>\".length,\n                -\"</li></ul>\".length\n            );\n        }\n        this.feedBackDiv.innerHTML = feedback_html;\n        if (typeof MathJax !== \"undefined\") {\n            this.queueMathJax(document.body);\n        }\n    }\n\n    /*==================================\n    === Functions for compare button ===\n    ==================================*/\n    enableCompareButton() {\n        this.compareButton.disabled = false;\n    }\n    // _`compareFITBAnswers`\n    compareFITBAnswers() {\n        var data = {};\n        data.div_id = this.divid;\n        data.course = eBookConfig.course;\n        jQuery.get(\n            `${eBookConfig.new_server_prefix}/assessment/gettop10Answers`,\n            data,\n            this.compareFITB\n        );\n    }\n    compareFITB(data, status, whatever) {\n        var answers = data.detail.res;\n        var misc = data.detail.miscdata;\n        var body = \"<table>\";\n        body += \"<tr><th>Answer</th><th>Count</th></tr>\";\n        for (var row in answers) {\n            body +=\n                \"<tr><td>\" +\n                answers[row].answer +\n                \"</td><td>\" +\n                answers[row].count +\n                \" times</td></tr>\";\n        }\n        body += \"</table>\";\n        var html =\n            \"<div class='modal fade'>\" +\n            \"    <div class='modal-dialog compare-modal'>\" +\n            \"        <div class='modal-content'>\" +\n            \"            <div class='modal-header'>\" +\n            \"                <button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>\" +\n            \"                <h4 class='modal-title'>Top Answers</h4>\" +\n            \"            </div>\" +\n            \"            <div class='modal-body'>\" +\n            body +\n            \"            </div>\" +\n            \"        </div>\" +\n            \"    </div>\" +\n            \"</div>\";\n        var el = $(html);\n        el.modal();\n    }\n\n    disableInteraction() {\n        for (var i = 0; i < this.blankArray.length; i++) {\n            this.blankArray[i].disabled = true;\n        }\n    }\n}\n\n/*=================================\n== Find the custom HTML tags and ==\n==   execute our code on them    ==\n=================================*/\n$(document).on(\"runestone:login-complete\", function () {\n    $(\"[data-component=fillintheblank]\").each(function (index) {\n        var opts = {\n            orig: this,\n            useRunestoneServices: eBookConfig.useRunestoneServices,\n        };\n        if ($(this).closest(\"[data-component=timedAssessment]\").length == 0) {\n            // If this element exists within a timed component, don't render it here\n            try {\n                window.componentMap[this.id] = new FITB(opts);\n            } catch (err) {\n                console.log(\n                    `Error rendering Fill in the Blank Problem ${this.id}\n                     Details: ${err}`\n                );\n            }\n        }\n    });\n});\n","import FITB from \"./fitb.js\";\nexport default class TimedFITB extends FITB {\n    constructor(opts) {\n        super(opts);\n        this.renderTimedIcon(this.inputDiv);\n        this.hideButtons();\n        this.needsReinitialization = true;\n    }\n    hideButtons() {\n        $(this.submitButton).hide();\n        $(this.compareButton).hide();\n    }\n    renderTimedIcon(component) {\n        // renders the clock icon on timed components.    The component parameter\n        // is the element that the icon should be appended to.\n        var timeIconDiv = document.createElement(\"div\");\n        var timeIcon = document.createElement(\"img\");\n        $(timeIcon).attr({\n            src: \"../_static/clock.png\",\n            style: \"width:15px;height:15px\",\n        });\n        timeIconDiv.className = \"timeTip\";\n        timeIconDiv.title = \"\";\n        timeIconDiv.appendChild(timeIcon);\n        $(component).prepend(timeIconDiv);\n    }\n    checkCorrectTimed() {\n        // Returns if the question was correct, incorrect, or skipped (return null in the last case)\n        switch (this.correct) {\n            case true:\n                return \"T\";\n            case false:\n                return \"F\";\n            default:\n                return null;\n        }\n    }\n    hideFeedback() {\n        for (var i = 0; i < this.blankArray.length; i++) {\n            $(this.blankArray[i]).removeClass(\"input-validation-error\");\n        }\n        this.feedBackDiv.style.display = \"none\";\n    }\n\n    reinitializeListeners() {\n        for (let blank of this.blankArray) {\n            $(blank).change(this.recordAnswered.bind(this));\n        }\n    }\n}\n\nif (typeof window.component_factory === \"undefined\") {\n    window.component_factory = {};\n}\nwindow.component_factory.fillintheblank = function (opts) {\n    if (opts.timed) {\n        return new TimedFITB(opts);\n    }\n    return new FITB(opts);\n};\n","/*==========================================\n=======    Master shortanswer.js    ========\n============================================\n===     This file contains the JS for    ===\n=== the Runestone shortanswer component. ===\n============================================\n===              Created by              ===\n===           Isaiah Mayerchak           ===\n===                7/2/15                ===\n===              Brad Miller             ===\n===                2019                  ===\n==========================================*/\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport \"./../css/shortanswer.css\";\n\nexport default class ShortAnswer extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        if (opts) {\n            var orig = opts.orig; // entire <p> element that will be replaced by new HTML\n            this.useRunestoneServices =\n                opts.useRunestoneServices || eBookConfig.useRunestoneServices;\n            this.origElem = orig;\n            this.divid = orig.id;\n            this.question = this.origElem.innerHTML;\n            this.optional = false;\n            this.attachURL = opts.attachURL;\n            if ($(this.origElem).is(\"[data-optional]\")) {\n                this.optional = true;\n            }\n            if ($(this.origElem).is(\"[data-mathjax]\")) {\n                this.mathjax = true;\n            }\n            if ($(this.origElem).is(\"[data-attachment]\")) {\n                this.attachment = true;\n            }\n            this.placeholder =\n                $(this.origElem).data(\"placeholder\") ||\n                \"Write your answer here\";\n            this.renderHTML();\n            this.caption = \"shortanswer\";\n            this.addCaption(\"runestone\");\n            this.checkServer(\"shortanswer\", true);\n            if (typeof Prism !== \"undefined\") {\n                Prism.highlightAllUnder(this.containerDiv);\n            }\n        }\n    }\n\n    renderHTML() {\n        this.containerDiv = document.createElement(\"div\");\n        this.containerDiv.id = this.divid;\n        $(this.containerDiv).addClass(this.origElem.getAttribute(\"class\"));\n        this.newForm = document.createElement(\"form\");\n        this.newForm.id = this.divid + \"_journal\";\n        this.newForm.name = this.newForm.id;\n        this.newForm.action = \"\";\n        this.containerDiv.appendChild(this.newForm);\n        this.fieldSet = document.createElement(\"fieldset\");\n        this.newForm.appendChild(this.fieldSet);\n        this.firstLegendDiv = document.createElement(\"div\");\n        this.firstLegendDiv.innerHTML = this.question;\n        $(this.firstLegendDiv).addClass(\"journal-question\");\n        this.fieldSet.appendChild(this.firstLegendDiv);\n        this.jInputDiv = document.createElement(\"div\");\n        this.jInputDiv.id = this.divid + \"_journal_input\";\n        this.fieldSet.appendChild(this.jInputDiv);\n        this.jOptionsDiv = document.createElement(\"div\");\n        $(this.jOptionsDiv).addClass(\"journal-options\");\n        this.jInputDiv.appendChild(this.jOptionsDiv);\n        this.jLabel = document.createElement(\"label\");\n        $(this.jLabel).addClass(\"radio-inline\");\n        this.jOptionsDiv.appendChild(this.jLabel);\n        this.jTextArea = document.createElement(\"textarea\");\n        let self = this;\n        this.jTextArea.onchange = function() {\n            self.isAnswered = true;\n        };\n        this.jTextArea.id = this.divid + \"_solution\";\n        $(this.jTextArea).attr(\"aria-label\", \"textarea\");\n        this.jTextArea.placeholder = this.placeholder;\n        $(this.jTextArea).css(\"display:inline, width:530px\");\n        $(this.jTextArea).addClass(\"form-control\");\n        this.jTextArea.rows = 4;\n        this.jTextArea.cols = 50;\n        this.jLabel.appendChild(this.jTextArea);\n        this.jTextArea.onchange = function() {\n            this.feedbackDiv.innerHTML = \"Your answer has not been saved yet!\";\n            $(this.feedbackDiv).removeClass(\"alert-success\");\n            $(this.feedbackDiv).addClass(\"alert alert-danger\");\n        }.bind(this);\n        this.fieldSet.appendChild(document.createElement(\"br\"));\n        if (this.mathjax) {\n            this.renderedAnswer = document.createElement(\"div\");\n            $(this.renderedAnswer).addClass(\"latexoutput\");\n            this.fieldSet.appendChild(this.renderedAnswer);\n        }\n        this.buttonDiv = document.createElement(\"div\");\n        this.fieldSet.appendChild(this.buttonDiv);\n        this.submitButton = document.createElement(\"button\");\n        $(this.submitButton).addClass(\"btn btn-success\");\n        this.submitButton.type = \"button\";\n        this.submitButton.textContent = \"Save\";\n        this.submitButton.onclick = function() {\n            this.checkCurrentAnswer();\n            this.logCurrentAnswer();\n            this.renderFeedback();\n        }.bind(this);\n        this.buttonDiv.appendChild(this.submitButton);\n        this.randomSpan = document.createElement(\"span\");\n        this.randomSpan.innerHTML = \"Instructor's Feedback\";\n        this.fieldSet.appendChild(this.randomSpan);\n        this.otherOptionsDiv = document.createElement(\"div\");\n        $(this.otherOptionsDiv).css(\"padding-left:20px\");\n        $(this.otherOptionsDiv).addClass(\"journal-options\");\n        this.fieldSet.appendChild(this.otherOptionsDiv);\n        // add a feedback div to give user feedback\n        this.feedbackDiv = document.createElement(\"div\");\n        //$(this.feedbackDiv).addClass(\"bg-info form-control\");\n        //$(this.feedbackDiv).css(\"width:530px, background-color:#eee, font-style:italic\");\n        $(this.feedbackDiv).css(\"width:530px, font-style:italic\");\n        this.feedbackDiv.id = this.divid + \"_feedback\";\n        this.feedbackDiv.innerHTML = \"You have not answered this question yet.\";\n        $(this.feedbackDiv).addClass(\"alert alert-danger\");\n        //this.otherOptionsDiv.appendChild(this.feedbackDiv);\n        this.fieldSet.appendChild(this.feedbackDiv);\n        if (this.attachment) {\n            let attachDiv = document.createElement(\"div\")\n            if (this.graderactive ) {\n                // If in grading mode make a button to create a popup with the image\n                let viewButton = document.createElement(\"button\")\n                viewButton.type = \"button\"\n                viewButton.innerHTML = \"View Attachment\"\n                viewButton.onclick = this.viewFile.bind(this);\n                attachDiv.appendChild(viewButton);\n            } else {\n                // Otherwise make a button for the student to select a file to upload.\n                this.fileUpload = document.createElement(\"input\")\n                this.fileUpload.type = \"file\";\n                this.fileUpload.id = `${this.divid}_fileme`;\n                attachDiv.appendChild(this.fileUpload);\n            }\n            this.containerDiv.appendChild(attachDiv);\n        }\n        //this.fieldSet.appendChild(document.createElement(\"br\"));\n        $(this.origElem).replaceWith(this.containerDiv);\n        // This is a stopgap measure for when MathJax is not loaded at all.  There is another\n        // more difficult case that when MathJax is loaded asynchronously we will get here\n        // before MathJax is loaded.  In that case we will need to implement something\n        // like `the solution described here <https://stackoverflow.com/questions/3014018/how-to-detect-when-mathjax-is-fully-loaded>`_\n        if (typeof MathJax !== \"undefined\") {\n            this.queueMathJax(this.containerDiv);\n        }\n    }\n\n    renderMath(value) {\n        if (this.mathjax) {\n            value = value.replace(/\\$\\$(.*?)\\$\\$/g, \"\\\\[ $1 \\\\]\");\n            value = value.replace(/\\$(.*?)\\$/g, \"\\\\( $1 \\\\)\");\n            $(this.renderedAnswer).text(value);\n            this.queueMathJax(this.renderedAnswer);\n        }\n    }\n\n    checkCurrentAnswer() {}\n\n    async logCurrentAnswer(sid) {\n        let value = $(document.getElementById(this.divid + \"_solution\")).val();\n        this.renderMath(value);\n        this.setLocalStorage({\n            answer: value,\n            timestamp: new Date(),\n        });\n        let data = {\n            event: \"shortanswer\",\n            act: value,\n            answer: value,\n            div_id: this.divid,\n        };\n        if (typeof sid !== \"undefined\") {\n            data.sid = sid;\n        }\n        await this.logBookEvent(data);\n        if (this.attachment) {\n            await this.uploadFile();\n        }\n    }\n\n    renderFeedback() {\n        this.feedbackDiv.innerHTML = \"Your answer has been saved.\";\n        $(this.feedbackDiv).removeClass(\"alert-danger\");\n        $(this.feedbackDiv).addClass(\"alert alert-success\");\n    }\n    setLocalStorage(data) {\n        if (!this.graderactive) {\n            let key = this.localStorageKey();\n            localStorage.setItem(key, JSON.stringify(data));\n        }\n    }\n    checkLocalStorage() {\n        // Repopulates the short answer text\n        // which was stored into local storage.\n        var answer = \"\";\n        if (this.graderactive) {\n            return;\n        }\n        var len = localStorage.length;\n        if (len > 0) {\n            var ex = localStorage.getItem(this.localStorageKey());\n            if (ex !== null) {\n                try {\n                    var storedData = JSON.parse(ex);\n                    answer = storedData.answer;\n                } catch (err) {\n                    // error while parsing; likely due to bad value stored in storage\n                    console.log(err.message);\n                    localStorage.removeItem(this.localStorageKey());\n                    return;\n                }\n                let solution = $(\"#\" + this.divid + \"_solution\");\n                solution.text(answer);\n                this.renderMath(answer);\n                this.feedbackDiv.innerHTML =\n                    \"Your current saved answer is shown above.\";\n                $(this.feedbackDiv).removeClass(\"alert-danger\");\n                $(this.feedbackDiv).addClass(\"alert alert-success\");\n            }\n        }\n    }\n    restoreAnswers(data) {\n        // Restore answers from storage retrieval done in RunestoneBase\n        // sometimes data.answer can be null\n        if (!data.answer) {\n            data.answer = \"\";\n        }\n        this.answer = data.answer;\n        this.jTextArea.value = this.answer;\n        this.renderMath(this.answer);\n\n        let p = document.createElement(\"p\");\n        this.jInputDiv.appendChild(p);\n        var tsString = \"\";\n        if (data.timestamp) {\n            tsString = new Date(data.timestamp).toLocaleString();\n        } else {\n            tsString = \"\";\n        }\n        $(p).text(tsString);\n        if (data.last_answer) {\n            this.current_answer = \"ontime\";\n            let toggle_answer_button = document.createElement(\"button\");\n            toggle_answer_button.type = \"button\";\n            $(toggle_answer_button).text(\"Show Late Answer\");\n            $(toggle_answer_button).addClass(\"btn btn-warning\");\n            $(toggle_answer_button).css(\"margin-left\", \"5px\");\n\n            $(toggle_answer_button).click(\n                function() {\n                    var display_timestamp, button_text;\n                    if (this.current_answer === \"ontime\") {\n                        this.jTextArea.value = data.last_answer;\n                        this.answer = data.last_answer;\n                        display_timestamp = new Date(\n                            data.last_timestamp\n                        ).toLocaleString();\n                        button_text = \"Show on-Time Answer\";\n                        this.current_answer = \"late\";\n                    } else {\n                        this.jTextArea.value = data.answer;\n                        this.answer = data.answer;\n                        display_timestamp = tsString;\n                        button_text = \"Show Late Answer\";\n                        this.current_answer = \"ontime\";\n                    }\n                    this.renderMath(this.answer);\n                    $(p).text(`Submitted: ${display_timestamp}`);\n                    $(toggle_answer_button).text(button_text);\n                }.bind(this)\n            );\n\n            this.buttonDiv.appendChild(toggle_answer_button);\n        }\n        let feedbackStr = \"Your current saved answer is shown above.\";\n        if (typeof data.score !== \"undefined\") {\n            feedbackStr = `Score: ${data.score}`;\n        }\n        if (data.comment) {\n            feedbackStr += ` -- ${data.comment}`;\n        }\n        this.feedbackDiv.innerHTML = feedbackStr;\n\n        $(this.feedbackDiv).removeClass(\"alert-danger\");\n        $(this.feedbackDiv).addClass(\"alert alert-success\");\n    }\n\n    disableInteraction() {\n        this.jTextArea.disabled = true;\n    }\n\n    async uploadFile() {\n        const files = this.fileUpload.files\n        const data = new FormData()\n        if (this.fileUpload.files.length > 0) {\n            data.append('file', files[0])\n            fetch(`/ns/logger/upload/${this.divid}`, {\n                    method: 'POST',\n                    body: data\n                })\n                .then(response => response.json())\n                .then(data => {\n                    console.log(data)\n                })\n                .catch(error => {\n                    console.error(error)\n                })\n            }\n    }\n\n    viewFile() {\n        // Get the URL from the S3 API -- saved when we display in grader mode\n        if (this.attachURL) {\n            //window.open(this.attachURL, \"_blank\");\n            const image_window = window.open(\"\", \"_blank\")\n            image_window.document.write(`\n                  <html>\n                    <head>\n                    </head>\n                    <body>\n                      <img src=\"${this.attachURL}\" alt=\"Attachment\" >\n                    </body>\n                  </html>\n            `);\n        } else {\n            alert(\"No attachment for this student.\")\n        }\n    }\n}\n\n/*=================================\n== Find the custom HTML tags and ==\n==   execute our code on them    ==\n=================================*/\n$(document).on(\"runestone:login-complete\", function() {\n    $(\"[data-component=shortanswer]\").each(function() {\n        if ($(this).closest(\"[data-component=timedAssessment]\").length == 0) {\n            // If this element exists within a timed component, don't render it here\n            try {\n                window.componentMap[this.id] = new ShortAnswer({\n                    orig: this,\n                    useRunestoneServices: eBookConfig.useRunestoneServices,\n                });\n            } catch (err) {\n                console.log(`Error rendering ShortAnswer Problem ${this.id}\n                Details: ${err}`);\n            }\n        }\n    });\n});\n","import ShortAnswer from \"./shortanswer.js\";\n\nexport default class TimedShortAnswer extends ShortAnswer {\n    constructor(opts) {\n        super(opts);\n        this.renderTimedIcon(this.containerDiv);\n        this.hideButtons();\n    }\n    hideButtons() {\n        $(this.submitButton).hide();\n    }\n    renderTimedIcon(component) {\n        // renders the clock icon on timed components.    The component parameter\n        // is the element that the icon should be appended to.\n        var timeIconDiv = document.createElement(\"div\");\n        var timeIcon = document.createElement(\"img\");\n        $(timeIcon).attr({\n            src: \"../_static/clock.png\",\n            style: \"width:15px;height:15px\",\n        });\n        timeIconDiv.className = \"timeTip\";\n        timeIconDiv.title = \"\";\n        timeIconDiv.appendChild(timeIcon);\n        $(component).prepend(timeIconDiv);\n    }\n    checkCorrectTimed() {\n        return \"I\"; // we ignore this in the grading\n    }\n    hideFeedback() {\n        $(this.feedbackDiv).hide();\n    }\n}\n\nif (typeof window.component_factory === \"undefined\") {\n    window.component_factory = {};\n}\n\nwindow.component_factory.shortanswer = function (opts) {\n    if (opts.timed) {\n        return new TimedShortAnswer(opts);\n    }\n    return new ShortAnswer(opts);\n};\n","/*==========================================\n========      Master timed.js     =========\n============================================\n===     This file contains the JS for    ===\n===     the Runestone timed component.   ===\n============================================\n===              Created By              ===\n===             Kirby Olson              ===\n===               6/11/15                ===\n==========================================*/\n\"use strict\";\n\nimport RunestoneBase from \"../../common/js/runestonebase.js\";\nimport TimedFITB from \"../../fitb/js/timedfitb.js\";\nimport TimedMC from \"../../mchoice/js/timedmc.js\";\nimport TimedShortAnswer from \"../../shortanswer/js/timed_shortanswer.js\";\nimport ACFactory from \"../../activecode/js/acfactory.js\";\nimport TimedClickableArea from \"../../clickableArea/js/timedclickable\";\nimport TimedDragNDrop from \"../../dragndrop/js/timeddnd.js\";\nimport TimedParsons from \"../../parsons/js/timedparsons.js\";\nimport SelectOne from \"../../selectquestion/js/selectone\";\nimport \"../css/timed.less\";\n\n// Timed constructor\nexport default class Timed extends RunestoneBase {\n    constructor(opts) {\n        super(opts);\n        var orig = opts.orig;\n        this.origElem = orig; // the entire element of this timed assessment and all of its children\n        this.divid = orig.id;\n        this.children = this.origElem.childNodes;\n        this.visited = [];\n        this.timeLimit = 0;\n        this.limitedTime = false;\n        if (!isNaN($(this.origElem).data(\"time\"))) {\n            this.timeLimit = parseInt($(this.origElem).data(\"time\"), 10) * 60; // time in seconds to complete the exam\n            this.startingTime = this.timeLimit;\n            this.limitedTime = true;\n        }\n        this.showFeedback = true;\n        if ($(this.origElem).is(\"[data-no-feedback]\")) {\n            this.showFeedback = false;\n        }\n        this.showResults = true;\n        if ($(this.origElem).is(\"[data-no-result]\")) {\n            this.showResults = false;\n        }\n        this.random = false;\n        if ($(this.origElem).is(\"[data-random]\")) {\n            this.random = true;\n        }\n        this.showTimer = true;\n        if ($(this.origElem).is(\"[data-no-timer]\")) {\n            this.showTimer = false;\n        }\n        this.fullwidth = false;\n        if ($(this.origElem).is(\"[data-fullwidth]\")) {\n            this.fullwidth = true;\n        }\n        this.nopause = false;\n        if ($(this.origElem).is(\"[data-no-pause]\")) {\n            this.nopause = true;\n        }\n        eBookConfig.enableScratchAC = false;\n        this.running = 0;\n        this.paused = 0;\n        this.done = 0;\n        this.taken = 0;\n        this.score = 0;\n        this.incorrect = 0;\n        this.correctStr = \"\";\n        this.incorrectStr = \"\";\n        this.skippedStr = \"\";\n        this.skipped = 0;\n        this.currentQuestionIndex = 0; // Which question is currently displaying on the page\n        this.renderedQuestionArray = []; // list of all problems\n        this.getNewChildren();\n        // One small step to eliminate students from doing view source\n        // this won't stop anyone with determination but may prevent casual peeking\n        if (!eBookConfig.enableDebug) {\n            document.body.oncontextmenu = function () {\n                return false;\n            };\n        }\n        this.checkAssessmentStatus().then(\n            function () {\n                this.renderTimedAssess();\n            }.bind(this)\n        );\n    }\n\n    getNewChildren() {\n        this.newChildren = [];\n        let runestoneChildren = this.origElem.querySelectorAll(\".runestone\");\n        for (var i = 0; i < runestoneChildren.length; i++) {\n            this.newChildren.push(runestoneChildren[i]);\n        }\n    }\n\n    async checkAssessmentStatus() {\n        // Has the user taken this exam?  Inquiring minds want to know\n        // If a user has not taken this exam then we want to make sure\n        // that if a question has been seen by the student before we do\n        // not populate previous answers.\n        let sendInfo = {\n            div_id: this.divid,\n            course_name: eBookConfig.course,\n        };\n        console.log(sendInfo);\n        if (eBookConfig.useRunestoneServices) {\n            let request = new Request(\n                `${eBookConfig.new_server_prefix}/assessment/tookTimedAssessment`,\n                {\n                    method: \"POST\",\n                    headers: this.jsonHeaders,\n                    body: JSON.stringify(sendInfo),\n                }\n            );\n            let response = await fetch(request);\n            let data = await response.json();\n            data = data.detail;\n            this.taken = data.tookAssessment;\n            this.assessmentTaken = this.taken;\n            if (!this.taken) {\n                localStorage.clear();\n            }\n            console.log(\"done with check status\");\n            return response;\n        } else {\n            this.taken = false;\n            this.assessmentTaken = false;\n            return Promise.resolve();\n        }\n    }\n\n    /*===============================\n    === Generating new Timed HTML ===\n    ===============================*/\n    async renderTimedAssess() {\n        console.log(\"rendering timed \");\n        // create renderedQuestionArray returns a promise\n        //\n        this.createRenderedQuestionArray();\n        if (this.random) {\n            this.randomizeRQA();\n        }\n        this.renderContainer();\n        this.renderTimer();\n        await this.renderControlButtons();\n        this.containerDiv.appendChild(this.timedDiv); // This can't be appended in renderContainer because then it renders above the timer and control buttons.\n        if (this.renderedQuestionArray.length > 1) this.renderNavControls();\n        this.renderSubmitButton();\n        this.renderFeedbackContainer();\n        this.useRunestoneServices = eBookConfig.useRunestoneServices;\n        // Replace intermediate HTML with rendered HTML\n        $(this.origElem).replaceWith(this.containerDiv);\n        // check if already taken and if so show results\n        this.styleExamElements(); // rename to renderPossibleResults\n        this.checkServer(\"timedExam\", true);\n    }\n\n    renderContainer() {\n        this.containerDiv = document.createElement(\"div\"); // container for the entire Timed Component\n        if (this.fullwidth) {\n            // allow the container to fill the width - barb\n            $(this.containerDiv).attr({\n                style: \"max-width:none\",\n            });\n        }\n        this.containerDiv.classList.add(\"runestone-sphinx\");\n        this.containerDiv.id = this.divid;\n        this.timedDiv = document.createElement(\"div\"); // div that will hold the questions for the timed assessment\n        this.navDiv = document.createElement(\"div\"); // For navigation control\n        $(this.navDiv).attr({\n            style: \"text-align:center\",\n        });\n        this.flagDiv = document.createElement(\"div\"); // div that will hold the \"Flag Question\" button\n        $(this.flagDiv).attr({\n            style: \"text-align: center\",\n        });\n        this.switchContainer = document.createElement(\"div\");\n        this.switchContainer.classList.add(\"switchcontainer\");\n        this.switchDiv = document.createElement(\"div\"); // is replaced by the questions\n        this.timedDiv.appendChild(this.navDiv);\n        this.timedDiv.appendChild(this.flagDiv); // add flagDiv to timedDiv, which holds components for navigation and questions for timed assessment\n        this.timedDiv.appendChild(this.switchContainer);\n        this.switchContainer.appendChild(this.switchDiv);\n        $(this.timedDiv).attr({\n            id: \"timed_Test\",\n            style: \"display:none\",\n        });\n    }\n\n    renderTimer() {\n        this.wrapperDiv = document.createElement(\"div\");\n        this.timerContainer = document.createElement(\"P\");\n        this.wrapperDiv.id = this.divid + \"-startWrapper\";\n        this.timerContainer.id = this.divid + \"-output\";\n        this.wrapperDiv.appendChild(this.timerContainer);\n        this.showTime();\n    }\n\n    renderControlButtons() {\n        this.controlDiv = document.createElement(\"div\");\n        $(this.controlDiv).attr({\n            id: \"controls\",\n            style: \"text-align: center\",\n        });\n        this.startBtn = document.createElement(\"button\");\n        this.pauseBtn = document.createElement(\"button\");\n        $(this.startBtn).attr({\n            class: \"btn btn-success\",\n            id: \"start\",\n            tabindex: \"0\",\n            role: \"button\",\n        });\n        this.startBtn.textContent = \"Start\";\n        this.startBtn.addEventListener(\n            \"click\",\n            async function () {\n                $(this.finishButton).hide(); // hide the finish button for now\n                $(this.flagButton).show();\n                let mess = document.createElement(\"p\");\n                mess.innerHTML =\n                    \"<strong>Warning: You will not be able to continue the exam if you close this tab, close the window, or navigate away from this page!</strong>  Make sure you click the Finish Exam button when you are done to submit your work!\";\n                this.controlDiv.appendChild(mess);\n                mess.classList.add(\"examwarning\");\n                await this.renderTimedQuestion();\n                this.startAssessment();\n            }.bind(this),\n            false\n        );\n        $(this.pauseBtn).attr({\n            class: \"btn btn-default\",\n            id: \"pause\",\n            disabled: \"true\",\n            tabindex: \"0\",\n            role: \"button\",\n        });\n        this.pauseBtn.textContent = \"Pause\";\n        this.pauseBtn.addEventListener(\n            \"click\",\n            function () {\n                this.pauseAssessment();\n            }.bind(this),\n            false\n        );\n        if (!this.taken) {\n            this.controlDiv.appendChild(this.startBtn);\n        }\n        if (!this.nopause) {\n            this.controlDiv.appendChild(this.pauseBtn);\n        }\n        this.containerDiv.appendChild(this.wrapperDiv);\n        this.containerDiv.appendChild(this.controlDiv);\n    }\n\n    renderNavControls() {\n        // making \"Prev\" button\n        this.pagNavList = document.createElement(\"ul\");\n        $(this.pagNavList).addClass(\"pagination\");\n        this.leftContainer = document.createElement(\"li\");\n        this.leftNavButton = document.createElement(\"button\");\n        this.leftNavButton.innerHTML = \"&#8249; Prev\";\n        $(this.leftNavButton).attr(\"aria-label\", \"Previous\");\n        $(this.leftNavButton).attr(\"tabindex\", \"0\");\n        $(this.leftNavButton).attr(\"role\", \"button\");\n        $(this.rightNavButton).attr(\"id\", \"prev\");\n        $(this.leftNavButton).css(\"cursor\", \"pointer\");\n        this.leftContainer.appendChild(this.leftNavButton);\n        this.pagNavList.appendChild(this.leftContainer);\n        // making \"Flag Question\" button\n        this.flaggingPlace = document.createElement(\"ul\");\n        $(this.flaggingPlace).addClass(\"pagination\");\n        this.flagContainer = document.createElement(\"li\");\n        this.flagButton = document.createElement(\"button\");\n        $(this.flagButton).addClass(\"flagBtn\");\n        this.flagButton.innerHTML = \"Flag Question\"; // name on button\n        $(this.flagButton).attr(\"aria-labelledby\", \"Flag\");\n        $(this.flagButton).attr(\"tabindex\", \"5\");\n        $(this.flagButton).attr(\"role\", \"button\");\n        $(this.flagButton).attr(\"id\", \"flag\");\n        $(this.flagButton).css(\"cursor\", \"pointer\");\n        this.flagContainer.appendChild(this.flagButton); // adding button to container\n        this.flaggingPlace.appendChild(this.flagContainer); // adding container to flaggingPlace\n        // making \"Next\" button\n        this.rightContainer = document.createElement(\"li\");\n        this.rightNavButton = document.createElement(\"button\");\n        $(this.rightNavButton).attr(\"aria-label\", \"Next\");\n        $(this.rightNavButton).attr(\"tabindex\", \"0\");\n        $(this.rightNavButton).attr(\"role\", \"button\");\n        $(this.rightNavButton).attr(\"id\", \"next\");\n        this.rightNavButton.innerHTML = \"Next &#8250;\";\n        $(this.rightNavButton).css(\"cursor\", \"pointer\");\n        this.rightContainer.appendChild(this.rightNavButton);\n        this.pagNavList.appendChild(this.rightContainer);\n        this.ensureButtonSafety();\n        this.navDiv.appendChild(this.pagNavList);\n        this.flagDiv.appendChild(this.flaggingPlace); // adds flaggingPlace to the flagDiv\n        this.break = document.createElement(\"br\");\n        this.navDiv.appendChild(this.break);\n        // render the question number jump buttons\n        this.qNumList = document.createElement(\"ul\");\n        $(this.qNumList).attr(\"id\", \"pageNums\");\n        this.qNumWrapperList = document.createElement(\"ul\");\n        $(this.qNumWrapperList).addClass(\"pagination\");\n        var tmpLi, tmpA;\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            tmpLi = document.createElement(\"li\");\n            tmpA = document.createElement(\"a\");\n            tmpA.innerHTML = i + 1;\n            $(tmpA).css(\"cursor\", \"pointer\");\n            if (i === 0) {\n                $(tmpLi).addClass(\"active\");\n            }\n            tmpLi.appendChild(tmpA);\n            this.qNumWrapperList.appendChild(tmpLi);\n        }\n        this.qNumList.appendChild(this.qNumWrapperList);\n        this.navDiv.appendChild(this.qNumList);\n        this.navBtnListeners();\n        this.flagBtnListener(); // listens for click on flag button\n        $(this.flagButton).hide();\n    }\n\n    // when moving off of a question in an active exam:\n    // 1. show that the question has been seen, or mark it broken if it is in error.\n    // 2. check and log the current answer\n    async navigateAway() {\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].state ==\n            \"broken_exam\"\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"broken\");\n        }\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].state ==\n            \"exam_ended\"\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"toolate\");\n        }\n        if (\n            this.renderedQuestionArray[this.currentQuestionIndex].question\n                .isAnswered\n        ) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"answered\");\n            await this.renderedQuestionArray[\n                this.currentQuestionIndex\n            ].question.checkCurrentAnswer();\n            if (!this.done) {\n                await this.renderedQuestionArray[\n                    this.currentQuestionIndex\n                ].question.logCurrentAnswer();\n            }\n        }\n    }\n    async handleNextPrev(event) {\n        if (!this.taken) {\n            await this.navigateAway();\n        }\n        var target = $(event.target).text();\n        if (target.match(/Next/)) {\n            // checks given text to match \"Next\"\n            if ($(this.rightContainer).hasClass(\"disabled\")) {\n                return;\n            }\n            this.currentQuestionIndex++;\n        } else if (target.match(/Prev/)) {\n            // checks given text to match \"Prev\"\n            if ($(this.leftContainer).hasClass(\"disabled\")) {\n                return;\n            }\n            this.currentQuestionIndex--;\n        }\n        await this.renderTimedQuestion();\n        this.ensureButtonSafety();\n        for (var i = 0; i < this.qNumList.childNodes.length; i++) {\n            for (\n                var j = 0;\n                j < this.qNumList.childNodes[i].childNodes.length;\n                j++\n            ) {\n                $(this.qNumList.childNodes[i].childNodes[j]).removeClass(\n                    \"active\"\n                );\n            }\n        }\n        $(\n            \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n        ).addClass(\"active\");\n        if (\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).hasClass(\"flagcolor\")\n        ) {\n            // checking for class\n            this.flagButton.innerHTML = \"Unflag Question\"; // changes text on button\n        } else {\n            this.flagButton.innerHTML = \"Flag Question\"; // changes text on button\n        }\n    }\n\n    async handleFlag(event) {\n        // called when flag button is clicked\n        var target = $(event.target).text();\n        if (target.match(/Flag Question/)) {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).addClass(\"flagcolor\"); // class will change color of question block\n            this.flagButton.innerHTML = \"Unflag Question\";\n        } else {\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n            ).removeClass(\"flagcolor\"); // will restore current color of question block\n            this.flagButton.innerHTML = \"Flag Question\"; // also sets name back\n        }\n    }\n\n    async handleNumberedNav(event) {\n        if (!this.taken) {\n            await this.navigateAway();\n        }\n        for (var i = 0; i < this.qNumList.childNodes.length; i++) {\n            for (\n                var j = 0;\n                j < this.qNumList.childNodes[i].childNodes.length;\n                j++\n            ) {\n                $(this.qNumList.childNodes[i].childNodes[j]).removeClass(\n                    \"active\"\n                );\n            }\n        }\n\n        var target = $(event.target).text();\n        let oldIndex = this.currentQuestionIndex;\n        this.currentQuestionIndex = parseInt(target) - 1;\n        if (this.currentQuestionIndex > this.renderedQuestionArray.length) {\n            console.log(`Error: bad index for ${target}`);\n            this.currentQuestionIndex = oldIndex;\n        }\n        $(\n            \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\"\n        ).addClass(\"active\");\n        if (\n            $(\n                \"ul#pageNums > ul > li:eq(\" + this.currentQuestionIndex + \")\" // checking for flagcolor class\n            ).hasClass(\"flagcolor\")\n        ) {\n            this.flagButton.innerHTML = \"Unflag Question\";\n        } else {\n            this.flagButton.innerHTML = \"Flag Question\";\n        }\n        await this.renderTimedQuestion();\n        this.ensureButtonSafety();\n    }\n\n    // set up events for navigation\n    navBtnListeners() {\n        // Next and Prev Listener\n        this.pagNavList.addEventListener(\n            \"click\",\n            this.handleNextPrev.bind(this),\n            false\n        );\n\n        // Numbered Listener\n        this.qNumList.addEventListener(\n            \"click\",\n            this.handleNumberedNav.bind(this),\n            false\n        );\n    }\n\n    // set up event for flag\n    flagBtnListener() {\n        this.flaggingPlace.addEventListener(\n            \"click\",\n            this.handleFlag.bind(this), // calls this to take action\n            false\n        );\n    }\n\n    renderSubmitButton() {\n        this.buttonContainer = document.createElement(\"div\");\n        $(this.buttonContainer).attr({\n            style: \"text-align:center\",\n        });\n        this.finishButton = document.createElement(\"button\");\n        $(this.finishButton).attr({\n            id: \"finish\",\n            class: \"btn btn-primary\",\n        });\n        this.finishButton.textContent = \"Finish Exam\";\n        this.finishButton.addEventListener(\n            \"click\",\n            async function () {\n                if (\n                    window.confirm(\n                        \"Clicking OK means you are ready to submit your answers and are finished with this assessment.\"\n                    )\n                ) {\n                    await this.finishAssessment();\n                    $(this.flagButton).hide();\n                }\n            }.bind(this),\n            false\n        );\n        this.controlDiv.appendChild(this.finishButton);\n        $(this.finishButton).hide();\n        this.timedDiv.appendChild(this.buttonContainer);\n    }\n    ensureButtonSafety() {\n        if (this.currentQuestionIndex === 0) {\n            if (this.renderedQuestionArray.length != 1) {\n                $(this.rightContainer).removeClass(\"disabled\");\n            }\n            $(this.leftContainer).addClass(\"disabled\");\n        }\n        if (\n            this.currentQuestionIndex >=\n            this.renderedQuestionArray.length - 1\n        ) {\n            if (this.renderedQuestionArray.length != 1) {\n                $(this.leftContainer).removeClass(\"disabled\");\n            }\n            $(this.rightContainer).addClass(\"disabled\");\n        }\n        if (\n            this.currentQuestionIndex > 0 &&\n            this.currentQuestionIndex < this.renderedQuestionArray.length - 1\n        ) {\n            $(this.rightContainer).removeClass(\"disabled\");\n            $(this.leftContainer).removeClass(\"disabled\");\n        }\n    }\n    renderFeedbackContainer() {\n        this.scoreDiv = document.createElement(\"P\");\n        this.scoreDiv.id = this.divid + \"results\";\n        this.scoreDiv.style.display = \"none\";\n        this.containerDiv.appendChild(this.scoreDiv);\n    }\n\n    createRenderedQuestionArray() {\n        // this finds all the assess questions in this timed assessment\n        // We need to make a list of all the questions up front so we can set up navigation\n        // but we do not want to render the questions until the student has navigated\n        // Also adds them to this.renderedQuestionArray\n\n        // todo:  This needs to be updated to account for the runestone div wrapper.\n\n        // To accommodate the selectquestion type -- which is async! we need to wrap\n        // all of this in a promise, so that we don't continue to render the timed\n        // exam until all of the questions have been realized.\n        var opts;\n        for (var i = 0; i < this.newChildren.length; i++) {\n            var tmpChild = this.newChildren[i];\n            opts = {\n                state: \"prepared\",\n                orig: tmpChild,\n                question: {},\n                useRunestoneServices: eBookConfig.useRunestoneServices,\n                timed: true,\n                assessmentTaken: this.taken,\n                timedWrapper: this.divid,\n                initAttempts: 0,\n            };\n            if ($(tmpChild).children(\"[data-component]\").length > 0) {\n                tmpChild = $(tmpChild).children(\"[data-component]\")[0];\n                opts.orig = tmpChild;\n            }\n            if ($(tmpChild).is(\"[data-component]\")) {\n                this.renderedQuestionArray.push(opts);\n            }\n        }\n    }\n\n    randomizeRQA() {\n        var currentIndex = this.renderedQuestionArray.length,\n            temporaryValue,\n            randomIndex;\n        // While there remain elements to shuffle...\n        while (currentIndex !== 0) {\n            // Pick a remaining element...\n            randomIndex = Math.floor(Math.random() * currentIndex);\n            currentIndex -= 1;\n            // And swap it with the current element.\n            temporaryValue = this.renderedQuestionArray[currentIndex];\n            this.renderedQuestionArray[currentIndex] =\n                this.renderedQuestionArray[randomIndex];\n            this.renderedQuestionArray[randomIndex] = temporaryValue;\n        }\n    }\n\n    async renderTimedQuestion() {\n        if (this.currentQuestionIndex >= this.renderedQuestionArray.length) {\n            // sometimes the user clicks in the event area for the qNumList\n            // But misses a number in that case the text is the concatenation\n            // of all the numbers in the list!\n            return;\n        }\n        // check the renderedQuestionArray to see if it has been rendered.\n        let opts = this.renderedQuestionArray[this.currentQuestionIndex];\n        let currentQuestion;\n        if (\n            opts.state === \"prepared\" ||\n            opts.state === \"forreview\" ||\n            (opts.state === \"broken_exam\" && opts.initAttempts < 3)\n        ) {\n            let tmpChild = opts.orig;\n            if ($(tmpChild).is(\"[data-component=selectquestion]\")) {\n                if (this.done && opts.state == \"prepared\") {\n                    this.renderedQuestionArray[\n                        this.currentQuestionIndex\n                    ].state = \"exam_ended\";\n                } else {\n                    // SelectOne is async and will replace itself in this array with\n                    // the actual selected question\n                    opts.rqa = this.renderedQuestionArray;\n                    let newq = new SelectOne(opts);\n                    this.renderedQuestionArray[this.currentQuestionIndex] = {\n                        question: newq,\n                    };\n                    try {\n                        await newq.initialize();\n                        if (opts.state == \"broken_exam\") {\n                            // remove the broken class from this question if we get here.\n                            $(\n                                `ul#pageNums > ul > li:eq(${this.currentQuestionIndex})`\n                            ).removeClass(\"broken\");\n                        }\n                    } catch (e) {\n                        opts.state = \"broken_exam\";\n                        this.renderedQuestionArray[this.currentQuestionIndex] =\n                            opts;\n                        console.log(\n                            `Error initializing question: Details ${e}`\n                        );\n                    }\n                }\n            } else if ($(tmpChild).is(\"[data-component]\")) {\n                let componentKind = $(tmpChild).data(\"component\");\n                this.renderedQuestionArray[this.currentQuestionIndex] = {\n                    question: window.component_factory[componentKind](opts),\n                    state: opts.state,\n                };\n            }\n        } else if (opts.state === \"broken_exam\") {\n            return;\n        }\n\n        currentQuestion =\n            this.renderedQuestionArray[this.currentQuestionIndex].question;\n        if (opts.state === \"forreview\") {\n            await currentQuestion.component_ready_promise;\n            await currentQuestion.checkCurrentAnswer();\n            currentQuestion.renderFeedback();\n            currentQuestion.disableInteraction();\n        }\n\n        if (!this.visited.includes(this.currentQuestionIndex)) {\n            this.visited.push(this.currentQuestionIndex);\n            if (\n                this.visited.length === this.renderedQuestionArray.length &&\n                !this.done\n            ) {\n                $(this.finishButton).show();\n            }\n        }\n\n        if (currentQuestion.containerDiv) {\n            if (\n                currentQuestion.containerDiv.classList.contains(\"runestone\") ==\n                false\n            ) {\n                currentQuestion.containerDiv.classList.add(\"runestone\");\n            }\n            $(this.switchDiv).replaceWith(currentQuestion.containerDiv);\n            this.switchDiv = currentQuestion.containerDiv;\n        }\n\n        // If the timed component has listeners, those might need to be reinitialized\n        // This flag will only be set in the elements that need it--it will be undefined in the others and thus evaluate to false\n        if (currentQuestion.needsReinitialization) {\n            currentQuestion.reinitializeListeners(this.taken);\n        }\n    }\n\n    /*=================================\n    === Timer and control Functions ===\n    =================================*/\n    handlePrevAssessment() {\n        $(this.startBtn).hide();\n        $(this.pauseBtn).attr(\"disabled\", true);\n        $(this.finishButton).attr(\"disabled\", true);\n        this.running = 0;\n        this.done = 1;\n        // showFeedback sand showResults should both be true before we show the\n        // questions and their state of correctness.\n        if (this.showResults && this.showFeedback) {\n            $(this.timedDiv).show();\n            this.restoreAnsweredQuestions(); // do not log these results\n        } else {\n            $(this.pauseBtn).hide();\n            $(this.timerContainer).hide();\n        }\n    }\n    startAssessment() {\n        if (!this.taken) {\n            $(\"#relations-next\").hide(); // hide the next page button for now\n            $(\"#relations-prev\").hide(); // hide the previous button for now\n            $(this.startBtn).hide();\n            $(this.pauseBtn).attr(\"disabled\", false);\n            if (this.running === 0 && this.paused === 0) {\n                this.running = 1;\n                this.lastTime = Date.now();\n                $(this.timedDiv).show();\n                this.increment();\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"start\",\n                    div_id: this.divid,\n                });\n                var timeStamp = new Date();\n                var storageObj = {\n                    answer: [0, 0, this.renderedQuestionArray.length, 0],\n                    timestamp: timeStamp,\n                };\n                localStorage.setItem(\n                    this.localStorageKey(),\n                    JSON.stringify(storageObj)\n                );\n            }\n            $(window).on(\n                \"beforeunload\",\n                function (event) {\n                    // this actual value gets ignored by newer browsers\n                    if (this.done) {\n                        return;\n                    }\n                    event.preventDefault();\n                    event.returnValue =\n                        \"Are you sure you want to leave?  Your work will be lost! And you will need your instructor to reset the exam!\";\n                    return \"Are you sure you want to leave?  Your work will be lost!\";\n                }.bind(this)\n            );\n            window.addEventListener(\n                \"pagehide\",\n                async function (event) {\n                    if (!this.done) {\n                        await this.finishAssessment();\n                        console.log(\"Exam exited by leaving page\");\n                    }\n                }.bind(this)\n            );\n        } else {\n            this.handlePrevAssessment();\n        }\n    }\n    pauseAssessment() {\n        if (this.done === 0) {\n            if (this.running === 1) {\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"pause\",\n                    div_id: this.divid,\n                });\n                this.running = 0;\n                this.paused = 1;\n                this.pauseBtn.innerHTML = \"Resume\";\n                $(this.timedDiv).hide();\n            } else {\n                this.logBookEvent({\n                    event: \"timedExam\",\n                    act: \"resume\",\n                    div_id: this.divid,\n                });\n                this.running = 1;\n                this.paused = 0;\n                this.increment();\n                this.pauseBtn.innerHTML = \"Pause\";\n                $(this.timedDiv).show();\n            }\n        }\n    }\n\n    showTime() {\n        if (this.showTimer) {\n            var mins = Math.floor(this.timeLimit / 60);\n            var secs = Math.floor(this.timeLimit) % 60;\n            var minsString = mins;\n            var secsString = secs;\n            if (mins < 10) {\n                minsString = \"0\" + mins;\n            }\n            if (secs < 10) {\n                secsString = \"0\" + secs;\n            }\n            var beginning = \"Time Remaining    \";\n            if (!this.limitedTime) {\n                beginning = \"Time Taken    \";\n            }\n            var timeString = beginning + minsString + \":\" + secsString;\n            if (this.done || this.taken) {\n                var minutes = Math.floor(this.timeTaken / 60);\n                var seconds = Math.floor(this.timeTaken % 60);\n                if (minutes < 10) {\n                    minutes = \"0\" + minutes;\n                }\n                if (seconds < 10) {\n                    seconds = \"0\" + seconds;\n                }\n                timeString = \"Time taken: \" + minutes + \":\" + seconds;\n            }\n            this.timerContainer.innerHTML = timeString;\n            var timeTips = document.getElementsByClassName(\"timeTip\");\n            for (var i = 0; i <= timeTips.length - 1; i++) {\n                timeTips[i].title = timeString;\n            }\n        } else {\n            $(this.timerContainer).hide();\n        }\n    }\n\n    increment() {\n        // if running (not paused) and not taken\n        if (this.running === 1 && !this.taken) {\n            setTimeout(\n                function () {\n                    // When a browser loses focus, setTimeout may not be called on the\n                    // schedule expected.  Browsers are free to save power by lengthening\n                    // the interval to some longer time.  So we cannot just subtract 1\n                    // from the timeLimit we need to measure the elapsed time from the last\n                    // call to the current call and subtract that number of seconds.\n                    let currentTime = Date.now();\n                    if (this.limitedTime) {\n                        // If there's a time limit, count down to 0\n                        this.timeLimit =\n                            this.timeLimit -\n                            Math.floor((currentTime - this.lastTime) / 1000);\n                    } else {\n                        // Else count up to keep track of how long it took to complete\n                        this.timeLimit =\n                            this.timeLimit +\n                            Math.floor((currentTime - this.lastTime) / 1000);\n                    }\n                    this.lastTime = currentTime;\n                    localStorage.setItem(\n                        eBookConfig.email + \":\" + this.divid + \"-time\",\n                        this.timeLimit\n                    );\n                    this.showTime();\n                    if (this.timeLimit > 0) {\n                        this.increment();\n                        // ran out of time\n                    } else {\n                        $(this.startBtn).attr({\n                            disabled: \"true\",\n                        });\n                        $(this.finishButton).attr({\n                            disabled: \"true\",\n                        });\n                        this.running = 0;\n                        this.done = 1;\n                        if (!this.taken) {\n                            this.taken = true;\n                            // embed the message in the page -- an alert actually prevents\n                            // the answers from being submitted and if a student closes their\n                            // laptop then the answers will not be submitted ever!  Even when they\n                            // reopen the laptop their session cookie is likely invalid.\n                            let mess = document.createElement(\"h1\");\n                            mess.innerHTML =\n                                \"Sorry but you ran out of time. Your answers are being submitted\";\n                            this.controlDiv.appendChild(mess);\n                            this.finishAssessment();\n                        }\n                    }\n                }.bind(this),\n                1000\n            );\n        }\n    }\n\n    styleExamElements() {\n        // Checks if this exam has been taken before\n        $(this.timerContainer).css({\n            width: \"50%\",\n            margin: \"0 auto\",\n            \"background-color\": \"#DFF0D8\",\n            \"text-align\": \"center\",\n            border: \"2px solid #DFF0D8\",\n            \"border-radius\": \"25px\",\n        });\n        $(this.scoreDiv).css({\n            width: \"50%\",\n            margin: \"0 auto\",\n            \"background-color\": \"#DFF0D8\",\n            \"text-align\": \"center\",\n            border: \"2px solid #DFF0D8\",\n            \"border-radius\": \"25px\",\n        });\n        $(\".tooltipTime\").css({\n            margin: \"0\",\n            padding: \"0\",\n            \"background-color\": \"black\",\n            color: \"white\",\n        });\n    }\n\n    async finishAssessment() {\n        $(\"#relations-next\").show(); // show the next page button for now\n        $(\"#relations-prev\").show(); // show the previous button for now\n        if (!this.showFeedback) {\n            // bje - changed from showResults\n            $(this.timedDiv).hide();\n            $(this.pauseBtn).hide();\n            $(this.timerContainer).hide();\n        }\n        this.findTimeTaken();\n        this.running = 0;\n        this.done = 1;\n        this.taken = 1;\n        await this.finalizeProblems();\n        this.checkScore();\n        this.displayScore();\n        this.storeScore();\n        this.logScore();\n        $(this.pauseBtn).attr(\"disabled\", true);\n        this.finishButton.disabled = true;\n        $(window).off(\"beforeunload\");\n        // turn off the pagehide listener\n        let assignment_id = this.divid;\n        setTimeout(function () {\n            jQuery.ajax({\n                url: eBookConfig.app + \"/assignments/student_autograde\",\n                type: \"POST\",\n                dataType: \"JSON\",\n                data: {\n                    assignment_id: assignment_id,\n                    is_timed: true,\n                },\n                success: function (retdata) {\n                    if (retdata.success == false) {\n                        console.log(retdata.message);\n                    } else {\n                        console.log(\"Autograder completed\");\n                    }\n                },\n            });\n        }, 2000);\n    }\n\n    // finalizeProblems\n    // ----------------\n    async finalizeProblems() {\n        // Because we have submitted each question as we navigate we only need to\n        // send the final version of the question the student is on when they press the\n        // finish exam button.\n\n        var currentQuestion =\n            this.renderedQuestionArray[this.currentQuestionIndex].question;\n        await currentQuestion.checkCurrentAnswer();\n        await currentQuestion.logCurrentAnswer();\n        currentQuestion.renderFeedback();\n        currentQuestion.disableInteraction();\n\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            let currentQuestion = this.renderedQuestionArray[i];\n            // set the state to forreview so we know that feedback may be appropriate\n            if (currentQuestion.state !== \"broken_exam\") {\n                currentQuestion.state = \"forreview\";\n                currentQuestion.question.disableInteraction();\n            }\n        }\n\n        if (!this.showFeedback) {\n            this.hideTimedFeedback();\n        }\n    }\n\n    // restoreAnsweredQuestions\n    // ------------------------\n    restoreAnsweredQuestions() {\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var currentQuestion = this.renderedQuestionArray[i];\n            if (currentQuestion.state === \"prepared\") {\n                currentQuestion.state = \"forreview\";\n            }\n        }\n    }\n\n    // hideTimedFeedback\n    // -----------------\n    hideTimedFeedback() {\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var currentQuestion = this.renderedQuestionArray[i].question;\n            currentQuestion.hideFeedback();\n        }\n    }\n\n    // checkScore\n    // ----------\n    // This is a simple all or nothing score of one point per question for\n    // that includes our best guess if a question was skipped.\n    checkScore() {\n        this.correctStr = \"\";\n        this.skippedStr = \"\";\n        this.incorrectStr = \"\";\n        // Gets the score of each problem\n        for (var i = 0; i < this.renderedQuestionArray.length; i++) {\n            var correct =\n                this.renderedQuestionArray[i].question.checkCorrectTimed();\n            if (correct == \"T\") {\n                this.score++;\n                this.correctStr = this.correctStr + (i + 1) + \", \";\n            } else if (correct == \"F\") {\n                this.incorrect++;\n                this.incorrectStr = this.incorrectStr + (i + 1) + \", \";\n            } else if (correct === null || correct === \"I\") {\n                this.skipped++;\n                this.skippedStr = this.skippedStr + (i + 1) + \", \";\n            } else {\n                // ignored question; just do nothing\n            }\n        }\n        // remove extra comma and space at end if any\n        if (this.correctStr.length > 0)\n            this.correctStr = this.correctStr.substring(\n                0,\n                this.correctStr.length - 2\n            );\n        else this.correctStr = \"None\";\n        if (this.skippedStr.length > 0)\n            this.skippedStr = this.skippedStr.substring(\n                0,\n                this.skippedStr.length - 2\n            );\n        else this.skippedStr = \"None\";\n        if (this.incorrectStr.length > 0)\n            this.incorrectStr = this.incorrectStr.substring(\n                0,\n                this.incorrectStr.length - 2\n            );\n        else this.incorrectStr = \"None\";\n    }\n    findTimeTaken() {\n        if (this.limitedTime) {\n            this.timeTaken = this.startingTime - this.timeLimit;\n        } else {\n            this.timeTaken = this.timeLimit;\n        }\n    }\n    storeScore() {\n        var storage_arr = [];\n        storage_arr.push(\n            this.score,\n            this.correctStr,\n            this.incorrect,\n            this.incorrectStr,\n            this.skipped,\n            this.skippedStr,\n            this.timeTaken\n        );\n        var timeStamp = new Date();\n        var storageObj = JSON.stringify({\n            answer: storage_arr,\n            timestamp: timeStamp,\n        });\n        localStorage.setItem(this.localStorageKey(), storageObj);\n    }\n    // _`timed exam endpoint parameters`\n    //----------------------------------\n    logScore() {\n        this.logBookEvent({\n            event: \"timedExam\",\n            act: \"finish\",\n            div_id: this.divid,\n            correct: this.score,\n            incorrect: this.incorrect,\n            skipped: this.skipped,\n            time_taken: this.timeTaken,\n        });\n    }\n    shouldUseServer(data) {\n        // We override the RunestoneBase version because there is no \"correct\" attribute, and there are 2 possible localStorage schemas\n        // --we also want to default to local storage because it contains more information specifically which questions are correct, incorrect, and skipped.\n        var storageDate;\n        if (localStorage.length === 0) return true;\n        var storageObj = localStorage.getItem(this.localStorageKey());\n        if (storageObj === null) return true;\n        try {\n            var storedData = JSON.parse(storageObj).answer;\n            if (storedData.length == 4) {\n                if (\n                    data.correct == storedData[0] &&\n                    data.incorrect == storedData[1] &&\n                    data.skipped == storedData[2] &&\n                    data.timeTaken == storedData[3]\n                )\n                    return true;\n            } else if (storedData.length == 7) {\n                if (\n                    data.correct == storedData[0] &&\n                    data.incorrect == storedData[2] &&\n                    data.skipped == storedData[4] &&\n                    data.timeTaken == storedData[6]\n                ) {\n                    return false; // In this case, because local storage has more info, we want to use that if it's consistent\n                }\n            }\n            storageDate = new Date(JSON.parse(storageObj[1]).timestamp);\n        } catch (err) {\n            // error while parsing; likely due to bad value stored in storage\n            console.log(err.message);\n            localStorage.removeItem(this.localStorageKey());\n            return true;\n        }\n        var serverDate = new Date(data.timestamp);\n        if (serverDate < storageDate) {\n            this.logScore();\n            return false;\n        }\n        return true;\n    }\n\n    checkLocalStorage() {\n        var len = localStorage.length;\n        if (len > 0) {\n            if (localStorage.getItem(this.localStorageKey()) !== null) {\n                this.taken = 1;\n                this.restoreAnswers(\"\");\n            } else {\n                this.taken = 0;\n            }\n        } else {\n            this.taken = 0;\n        }\n    }\n    async restoreAnswers(data) {\n        this.taken = 1;\n        var tmpArr;\n        if (data === \"\") {\n            try {\n                tmpArr = JSON.parse(\n                    localStorage.getItem(this.localStorageKey())\n                ).answer;\n            } catch (err) {\n                // error while parsing; likely due to bad value stored in storage\n                console.log(err.message);\n                localStorage.removeItem(this.localStorageKey());\n                this.taken = 0;\n                return;\n            }\n        } else {\n            // Parse results from the database\n            tmpArr = [\n                parseInt(data.correct),\n                parseInt(data.incorrect),\n                parseInt(data.skipped),\n                parseInt(data.time_taken),\n                data.reset,\n            ];\n            this.setLocalStorage(tmpArr);\n        }\n        if (tmpArr.length == 1) {\n            // Exam was previously reset\n            this.reset = true;\n            this.taken = 0;\n            return;\n        }\n        if (tmpArr.length == 4) {\n            // Accidental Reload OR Database Entry\n            this.score = tmpArr[0];\n            this.incorrect = tmpArr[1];\n            this.skipped = tmpArr[2];\n            this.timeTaken = tmpArr[3];\n        } else if (tmpArr.length == 5) {\n            this.score = tmpArr[0];\n            this.incorrect = tmpArr[1];\n            this.skipped = tmpArr[2];\n            this.timeTaken = tmpArr[3];\n        } else if (tmpArr.length == 7) {\n            // Loaded Completed Exam\n            this.score = tmpArr[0];\n            this.correctStr = tmpArr[1];\n            this.incorrect = tmpArr[2];\n            this.incorrectStr = tmpArr[3];\n            this.skipped = tmpArr[4];\n            this.skippedStr = tmpArr[5];\n            this.timeTaken = tmpArr[6];\n        } else {\n            // Set localStorage in case of \"accidental\" reload\n            this.score = 0;\n            this.incorrect = 0;\n            this.skipped = this.renderedQuestionArray.length;\n            this.timeTaken = 0;\n        }\n        if (this.taken) {\n            if (this.skipped === this.renderedQuestionArray.length) {\n                this.showFeedback = false;\n            }\n            this.handlePrevAssessment();\n        }\n        await this.renderTimedQuestion();\n        this.displayScore();\n        this.showTime();\n    }\n    setLocalStorage(parsedData) {\n        var timeStamp = new Date();\n        var storageObj = {\n            answer: parsedData,\n            timestamp: timeStamp,\n        };\n        localStorage.setItem(\n            this.localStorageKey(),\n            JSON.stringify(storageObj)\n        );\n    }\n    displayScore() {\n        if (this.showResults) {\n            var scoreString = \"\";\n            var numQuestions;\n            var percentCorrect;\n            // if we have some information\n            if (\n                this.correctStr.length > 0 ||\n                this.incorrectStr.length > 0 ||\n                this.skippedStr.length > 0\n            ) {\n                scoreString = `Num Correct: ${this.score}. Questions: ${this.correctStr}<br>Num Wrong: ${this.incorrect}. Questions: ${this.incorrectStr}<br>Num Skipped: ${this.skipped}. Questions: ${this.skippedStr}<br>`;\n                numQuestions = this.score + this.incorrect + this.skipped;\n                percentCorrect = (this.score / numQuestions) * 100;\n                scoreString +=\n                    \"Percent Correct: \" + percentCorrect.toFixed(2) + \"%\";\n                $(this.scoreDiv).html(scoreString);\n                this.scoreDiv.style.display = \"block\";\n            } else {\n                scoreString = `Num Correct: ${this.score}<br>Num Wrong: ${this.incorrect}<br>Num Skipped: ${this.skipped}<br>`;\n                numQuestions = this.score + this.incorrect + this.skipped;\n                percentCorrect = (this.score / numQuestions) * 100;\n                scoreString +=\n                    \"Percent Correct: \" + percentCorrect.toFixed(2) + \"%\";\n                $(this.scoreDiv).html(scoreString);\n                this.scoreDiv.style.display = \"block\";\n            }\n            this.highlightNumberedList();\n        } else {\n            $(this.scoreDiv).html(\n                \"Thank you for taking the exam.  Your answers have been recorded.\"\n            );\n            this.scoreDiv.style.display = \"block\";\n        }\n    }\n    highlightNumberedList() {\n        var correctCount = this.correctStr;\n        var incorrectCount = this.incorrectStr;\n        var skippedCount = this.skippedStr;\n        correctCount = correctCount.replace(/ /g, \"\").split(\",\");\n        incorrectCount = incorrectCount.replace(/ /g, \"\").split(\",\");\n        skippedCount = skippedCount.replace(/ /g, \"\").split(\",\");\n        $(function () {\n            var numberedBtns = $(\"ul#pageNums > ul > li\");\n            if (numberedBtns.hasClass(\"answered\")) {\n                numberedBtns.removeClass(\"answered\");\n            }\n            for (var i = 0; i < correctCount.length; i++) {\n                var test = parseInt(correctCount[i]) - 1;\n                numberedBtns\n                    .eq(parseInt(correctCount[i]) - 1)\n                    .addClass(\"correctCount\");\n            }\n            for (var j = 0; j < incorrectCount.length; j++) {\n                numberedBtns\n                    .eq(parseInt(incorrectCount[j]) - 1)\n                    .addClass(\"incorrectCount\");\n            }\n            for (var k = 0; k < skippedCount.length; k++) {\n                numberedBtns\n                    .eq(parseInt(skippedCount[k]) - 1)\n                    .addClass(\"skippedCount\");\n            }\n        });\n    }\n}\n\n/*=======================================================\n=== Function that calls the constructors on page load ===\n=======================================================*/\n$(document).on(\"runestone:login-complete\", function () {\n    $(\"[data-component=timedAssessment]\").each(function (index) {\n        window.componentMap[this.id] = new Timed({\n            orig: this,\n            useRunestoneServices: eBookConfig.useRunestoneServices,\n        });\n    });\n});\n"],"names":["$","i18n","load","en","msg_no_answer","msg_fitb_check_me","msg_fitb_compare_me","FITB","constructor","opts","super","orig","this","useRunestoneServices","origElem","divid","id","correct","feedbackArray","JSON","parse","scriptSelector","html","createFITBElement","caption","addCaption","checkServer","Prism","highlightAllUnder","containerDiv","root_node","find","renderFITBInput","renderFITBButtons","renderFITBFeedbackDiv","replaceWith","document","createElement","children","clone","appendTo","remove","ba","attr","blankArray","toArray","blank","change","recordAnswered","bind","isAnswered","submitButton","textContent","class","name","type","addEventListener","checkCurrentAnswer","logCurrentAnswer","appendChild","compareButton","disabled","compareFITBAnswers","feedBackDiv","restoreAnswers","data","arr","answer","Array","isArray","Error","err","split","i","length","displayFeed","isCorrectArray","renderFeedback","checkLocalStorage","storedData","graderactive","localStorage","ex","getItem","localStorageKey","console","log","message","removeItem","setLocalStorage","key","setItem","stringify","given_arr","push","value","eBookConfig","enableCompareMe","enableCompareButton","evaluateAnswers","isTimed","sid","feedback","timestamp","Date","event","act","div_id","logBookEvent","detail","given","fbl","j","RegExp","test","assert","min","max","actual","is_correct","percent","filter","Boolean","removeClass","addClass","feedback_html","slice","innerHTML","MathJax","queueMathJax","body","course","jQuery","get","new_server_prefix","compareFITB","status","whatever","answers","res","miscdata","row","count","modal","disableInteraction","on","each","index","closest","window","componentMap","TimedFITB","renderTimedIcon","inputDiv","hideButtons","needsReinitialization","hide","component","timeIconDiv","timeIcon","src","style","className","title","prepend","checkCorrectTimed","hideFeedback","display","reinitializeListeners","component_factory","fillintheblank","timed","ShortAnswer","question","optional","attachURL","is","mathjax","attachment","placeholder","renderHTML","getAttribute","newForm","action","fieldSet","firstLegendDiv","jInputDiv","jOptionsDiv","jLabel","jTextArea","self","onchange","css","rows","cols","feedbackDiv","renderedAnswer","buttonDiv","onclick","randomSpan","otherOptionsDiv","attachDiv","viewButton","viewFile","fileUpload","renderMath","replace","text","getElementById","val","uploadFile","p","tsString","toLocaleString","last_answer","current_answer","toggle_answer_button","click","display_timestamp","button_text","last_timestamp","feedbackStr","score","comment","files","FormData","append","fetch","method","then","response","json","catch","error","open","write","alert","TimedShortAnswer","shortanswer","Timed","childNodes","visited","timeLimit","limitedTime","isNaN","parseInt","startingTime","showFeedback","showResults","random","showTimer","fullwidth","nopause","enableScratchAC","running","paused","done","taken","incorrect","correctStr","incorrectStr","skippedStr","skipped","currentQuestionIndex","renderedQuestionArray","getNewChildren","enableDebug","oncontextmenu","checkAssessmentStatus","renderTimedAssess","newChildren","runestoneChildren","querySelectorAll","sendInfo","course_name","request","Request","headers","jsonHeaders","tookAssessment","assessmentTaken","clear","Promise","resolve","createRenderedQuestionArray","randomizeRQA","renderContainer","renderTimer","renderControlButtons","timedDiv","renderNavControls","renderSubmitButton","renderFeedbackContainer","styleExamElements","classList","add","navDiv","flagDiv","switchContainer","switchDiv","wrapperDiv","timerContainer","showTime","controlDiv","startBtn","pauseBtn","tabindex","role","async","finishButton","flagButton","show","mess","renderTimedQuestion","startAssessment","pauseAssessment","tmpLi","tmpA","pagNavList","leftContainer","leftNavButton","rightNavButton","flaggingPlace","flagContainer","rightContainer","ensureButtonSafety","break","qNumList","qNumWrapperList","navBtnListeners","flagBtnListener","navigateAway","state","handleNextPrev","target","match","hasClass","handleFlag","handleNumberedNav","oldIndex","buttonContainer","confirm","finishAssessment","scoreDiv","tmpChild","timedWrapper","initAttempts","temporaryValue","randomIndex","currentIndex","Math","floor","currentQuestion","rqa","newq","initialize","e","componentKind","component_ready_promise","includes","contains","handlePrevAssessment","restoreAnsweredQuestions","lastTime","now","increment","timeStamp","storageObj","preventDefault","returnValue","mins","secs","minsString","secsString","beginning","timeString","minutes","timeTaken","seconds","timeTips","getElementsByClassName","setTimeout","currentTime","email","width","margin","border","padding","color","findTimeTaken","finalizeProblems","checkScore","displayScore","storeScore","logScore","off","assignment_id","ajax","url","app","dataType","is_timed","success","retdata","hideTimedFeedback","substring","storage_arr","time_taken","shouldUseServer","storageDate","tmpArr","reset","parsedData","numQuestions","scoreString","toFixed","highlightNumberedList","correctCount","incorrectCount","skippedCount","numberedBtns","eq","k"],"sourceRoot":""}