<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title><title><no title></title></title>
  <meta http-equiv="content-type" content="text/html; charset=None">
  <link rel="stylesheet" href="pygments.css" type="text/css">
</head>
<body>
<h2><title><no title></title></h2>

<div class="highlight"><pre><span></span><span class="o">!</span><span class="kd">function</span><span class="p">(){</span><span class="s2">&quot;undefined&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nb">window</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nb">window</span><span class="o">=</span><span class="nx">root</span><span class="p">);</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="o">||</span><span class="p">{},</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">core</span><span class="o">=</span><span class="p">{});</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">string</span><span class="o">=</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">string</span><span class="o">||</span><span class="p">{};</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">formatStr</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="mf">1</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">){</span><span class="kd">var</span> <span class="nx">r</span><span class="o">=</span><span class="nx">n</span><span class="o">-</span><span class="mf">1</span><span class="p">,</span><span class="nx">o</span><span class="o">=</span><span class="ow">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;\\</span><span class="cp">{{</span><span class="m">1</span><span class="o">}</span><span class="s2">&quot;+r.toString()+&quot;</span><span class="o">{</span><span class="m">1</span><span class="o">}</span><span class="err">\\</span><span class="o">}{</span><span class="m">1</span><span class="o">}</span><span class="s2">&quot;,&quot;</span><span class="nv">g</span><span class="s2">&quot;);e=e.replace(o,arguments[n])}return e},window.excelFormulaUtilities.string.trim=function(t){return t.replace(/^\s|\s$/,&quot;&quot;)},window.excelFormulaUtilities.string.trim=function(t){return t.replace(/^(?:\s|&amp;nbsp;|&lt;\s*br\s*\/*\s*&gt;)*|(?:\s|&amp;nbsp;|&lt;\s*br\s*\/*\s*&gt;)*$/,&quot;&quot;)},t.isFunction=function(t){return&quot;</span><span class="nv">function</span><span class="s2">&quot;==typeof t}),n=t.isArray=function(t){return&quot;</span><span class="nv">object</span><span class="s2">&quot;==typeof t&amp;&amp;t.length},r=t.isWindow=function(){return obj&amp;&amp;&quot;</span><span class="nv">object</span><span class="s2">&quot;==typeof obj&amp;&amp;&quot;</span><span class="nv">setInterval</span><span class="s2">&quot;in obj},o=t.isPlainObject=function(t){if(!t||&quot;</span><span class="nv">object</span><span class="s2">&quot;!=typeof t||t.nodeType||r(t))return!1;if(t.constructor&amp;&amp;!hasOwnProperty.call(t,&quot;</span><span class="nv">constructor</span><span class="s2">&quot;)&amp;&amp;!hasOwnProperty.call(t.constructor.prototype,&quot;</span><span class="nv">isPrototypeOf</span><span class="s2">&quot;))return!1;var e;for(e in t);return void 0===e||hasOwnProperty.call(t,e)};t.extend=function(){var r,i,a,s,p,u,l=arguments[0]||{},c=1,d=arguments.length,g=!1;for(&quot;</span><span class="nv">boolean</span><span class="s2">&quot;==typeof l&amp;&amp;(g=l,l=arguments[1]||{},c=2),&quot;</span><span class="nv">object</span><span class="s2">&quot;==typeof l||e(l)||(l={}),d===c&amp;&amp;(l=this,--c);c&lt;d;c++)if(null!=(r=arguments[c]))for(i in r)a=l[i],s=r[i],l!==s&amp;&amp;(g&amp;&amp;s&amp;&amp;(o(s)||(p=n(s)))?(p?(p=!1,u=a&amp;&amp;n(a)?a:[]):u=a&amp;&amp;o(a)?a:{},l[i]=t.extend(g,u,s)):void 0!==s&amp;&amp;(l[i]=s));return l}}(),function(t){function e(t,e,n){this.value=t,this.type=e,this.subtype=n}function n(){this.items=[],this.add=function(t,n,r){r||(r=&quot;&quot;);var o=new e(t,n,r);return this.addRef(o),o},this.addRef=function(t){this.items.push(t)},this.index=-1,this.reset=function(){this.index=-1},this.BOF=function(){return this.index&lt;=0},this.EOF=function(){return this.index&gt;=this.items.length-1},this.moveNext=function(){return!this.EOF()&amp;&amp;(this.index+=1,!0)},this.current=function(){return this.index===-1?null:this.items[this.index]},this.next=function(){return this.EOF()?null:this.items[this.index+1]},this.previous=function(){return this.index&lt;1?null:this.items[this.index-1]}}function r(){this.items=[],this.push=function(t){this.items.push(t)},this.pop=function(t){var n=this.items.pop();return new e(t||&quot;&quot;,n.type,k)},this.token=function(){return this.items.length&gt;0?this.items[this.items.length-1]:null},this.value=function(){return this.token()?this.token().value.toString():&quot;&quot;},this.type=function(){return this.token()?this.token().type.toString():&quot;&quot;},this.subtype=function(){return this.token()?this.token().subtype.toString():&quot;&quot;}}function o(e){for(var o=new n,i=new r,a=0,s=function(){return e.substr(a,1)},p=function(){return e.substr(a,2)},u=function(){return e.substr(a+1,1)},l=function(){return a&gt;=e.length},c=&quot;&quot;,C=!1,N=!1,Y=!1,K=!1,B=/^[1-9]{1}(\.[0-9]+)?E{1}$/;e.length&gt;0;){if(&quot;</span> <span class="s2">&quot;!==e.substr(0,1)){&quot;</span><span class="o">=</span><span class="s2">&quot;===e.substr(0,1)&amp;&amp;(e=e.substr(1));break}e=e.substr(1)}for(;!l();)if(C)&#39;&quot;</span><span class="s1">&#39;===s()?&#39;</span><span class="s2">&quot;&#39;===u()?(c+=&#39;&quot;</span><span class="s1">&#39;,a+=1):(C=!1,o.add(c,g,v),c=&quot;&quot;):c+=s(),a+=1;else if(N)&quot;&#39;</span><span class="s2">&quot;===s()?&quot;</span><span class="s1">&#39;&quot;===u()?(c+=&quot;&#39;</span><span class="s2">&quot;,a+=1):(N=!1,c+=&quot;</span><span class="s1">&#39;&quot;):c+=s(),a+=1;else if(Y)&quot;]&quot;===s()&amp;&amp;(Y=!1),c+=s(),a+=1;else if(K)c+=s(),a+=1,&quot;,#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,&quot;.indexOf(&quot;,&quot;+c+&quot;,&quot;)!==-1&amp;&amp;(K=!1,o.add(c,g,R),c=&quot;&quot;);else if(&quot;+-&quot;.indexOf(s())!==-1&amp;&amp;c.length&gt;1&amp;&amp;c.match(B))c+=s(),a+=1;else if(&#39;</span><span class="s2">&quot;&#39;!==s())if(&quot;</span><span class="s1">&#39;&quot;!==s())if(&quot;[&quot;!==s())if(&quot;#&quot;!==s())if(&quot;{&quot;!==s())if(&quot;;&quot;!==s())if(&quot;}&quot;!==s())if(&quot; &quot;!==s())&quot;,&gt;=,&lt;=,&lt;&gt;,&quot;.indexOf(&quot;,&quot;+p()+&quot;,&quot;)===-1?&quot;+-*/^&amp;=&gt;&lt;&quot;.indexOf(s())===-1?&quot;%&quot;.indexOf(s())===-1?&quot;(&quot;!==s()?&quot;,&quot;!==s()||t.excelFormulaUtilities.isEu?&quot;)&quot;!==s()?(c+=s(),a+=1):(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.addRef(i.pop()),a+=1):(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),i.type()!==f?o.add(s(),h,P):o.add(s(),S),a+=1):(c.length&gt;0?(i.push(o.add(c,f,O)),c=&quot;&quot;):i.push(o.add(&quot;&quot;,m,O)),a+=1):(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.add(s(),y),a+=1):(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.add(s(),h),a+=1):(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.add(p(),h,E),a+=2);else for(c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.add(&quot;&quot;,T),a+=1;&quot; &quot;===s()&amp;&amp;!l();)a+=1;else c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.addRef(i.pop(&quot;ARRAYROWSTOP&quot;)),o.addRef(i.pop(&quot;ARRAYSTOP&quot;)),a+=1;else{if(t.excelFormulaUtilities.isEu){c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),i.type()!==f?o.add(s(),h,P):o.add(s(),S),a+=1;continue}c.length&gt;0&amp;&amp;(o.add(c,g),c=&quot;&quot;),o.addRef(i.pop()),o.add(&quot;,&quot;,S),i.push(o.add(&quot;ARRAYROW&quot;,f,O)),a+=1}else c.length&gt;0&amp;&amp;(o.add(c,x),c=&quot;&quot;),i.push(o.add(&quot;ARRAY&quot;,f,O)),i.push(o.add(&quot;ARRAYROW&quot;,f,O)),a+=1;else c.length&gt;0&amp;&amp;(o.add(c,x),c=&quot;&quot;),K=!0,c+=s(),a+=1;else Y=!0,c+=s(),a+=1;else c.length&gt;0&amp;&amp;(o.add(c,x),c=&quot;&quot;),c=&quot;&#39;</span><span class="s2">&quot;,N=!0,a+=1;else c.length&gt;0&amp;&amp;(o.add(c,x),c=&quot;&quot;),C=!0,a+=1;c.length&gt;0&amp;&amp;o.add(c,g);for(var I=new n;o.moveNext();)if(c=o.current(),c.type.toString()!==T)I.addRef(c);else{var L=o.BOF()||o.EOF();L=L&amp;&amp;(o.previous().type.toString()===f&amp;&amp;o.previous().subtype.toString()===k||o.previous().type.toString()===m&amp;&amp;o.previous().subtype.toString()===k||o.previous().type.toString()===g),L=L&amp;&amp;(o.next().type.toString()===f&amp;&amp;o.next().subtype.toString()===O||o.next().type.toString()===m&amp;&amp;o.next().subtype.toString()===O||o.next().type.toString()===g),L&amp;&amp;I.add(c.value.toString(),h,F)}for(;I.moveNext();)c=I.current(),c.type.toString()!==h||&quot;</span><span class="o">-</span><span class="s2">&quot;!==c.value.toString()?c.type.toString()!==h||&quot;</span><span class="o">+</span><span class="s2">&quot;!==c.value.toString()?c.type.toString()!==h||0!==c.subtype.length?c.type.toString()!==g||0!==c.subtype.length?c.type.toString()!==f||&quot;</span><span class="err">@</span><span class="s2">&quot;===c.value.substr(0,1)&amp;&amp;(c.value=c.value.substr(1).toString()):isNaN(parseFloat(c.value))?&quot;</span><span class="nv">TRUE</span><span class="s2">&quot;===c.value.toString()||&quot;</span><span class="nv">FALSE</span><span class="s2">&quot;===c.value.toString()?c.subtype=E.toString():c.subtype=_.toString():c.subtype=w.toString():&quot;</span><span class="o">&lt;&gt;=</span><span class="s2">&quot;.indexOf(c.value.substr(0,1))!==-1?c.subtype=E.toString():&quot;</span><span class="err">&amp;</span><span class="s2">&quot;===c.value.toString()?c.subtype=U.toString():c.subtype=A.toString():I.BOF()?c.type=d.toString():I.previous().type.toString()===f&amp;&amp;I.previous().subtype.toString()===k||I.previous().type.toString()===m&amp;&amp;I.previous().subtype.toString()===k||I.previous().type.toString()===y||I.previous().type.toString()===g?c.subtype=A.toString():c.type=d.toString():I.BOF()?c.type=b.toString():I.previous().type.toString()===f&amp;&amp;I.previous().subtype.toString()===k||I.previous().type.toString()===m&amp;&amp;I.previous().subtype.toString()===k||I.previous().type.toString()===y||I.previous().type.toString()===g?c.subtype=A.toString():c.type=b.toString();for(I.reset(),o=new n;I.moveNext();)I.current().type.toString()!==d&amp;&amp;o.addRef(I.current());return o.reset(),o}function i(t,e){if(!RegExp(&quot;</span><span class="o">[</span><span class="nv">a-z</span><span class="o">]+[</span><span class="m">0</span><span class="o">-</span><span class="m">9</span><span class="o">]+:[</span><span class="nv">a-z</span><span class="o">]+[</span><span class="m">0</span><span class="o">-</span><span class="m">9</span><span class="o">]+</span><span class="s2">&quot;,&quot;</span><span class="nv">gi</span><span class="s2">&quot;).test(t))throw&quot;</span><span class="nv">This</span> <span class="k">is</span> <span class="k">not</span> <span class="nf">a</span> <span class="nv">valid</span> <span class="nv">range</span><span class="o">:</span> <span class="s2">&quot;+t;var n=t.split(&quot;:&quot;),r=parseInt(n[0].match(/[0-9]+/gi)[0]),o=n[0].match(/[A-Z]+/gi)[0],i=N(o);for(endRow=parseInt(n[1].match(/[0-9]+/gi)[0]),endCol=n[1].match(/[A-Z]+/gi)[0],endColDec=N(endCol),totalRows=endRow-r+1,totalCols=N(endCol)-N(o)+1,curCol=0,curRow=1,curCell=&quot;&quot;,retStr=&quot;&quot;;curRow&lt;=totalRows;curRow+=1){for(;curCol&lt;totalCols;curCol+=1)curCell=C(i+curCol)+&quot;&quot;+(r+curRow-1),retStr+=curCell+(curRow===totalRows&amp;&amp;curCol===totalCols-1?&quot;&quot;:e);curCol=0}return retStr}function a(t,e,n,r,o){var i=n,a=void 0===typeof arguments[5]||null===arguments[5]?null:arguments[5],s=function(t){return t.replace(/\{\{token\}\}/gi,&quot;</span><span class="o">{</span><span class="m">0</span><span class="o">}</span><span class="s2">&quot;).replace(/\{\{autoindent\}\}/gi,&quot;</span><span class="o">{</span><span class="m">1</span><span class="o">}</span><span class="s2">&quot;).replace(/\{\{autolinebreak\}\}/gi,&quot;</span><span class="o">{</span><span class="m">2</span><span class="o">}</span><span class="s2">&quot;)},p=&quot;&quot;;if(p=&quot;</span><span class="nv">text</span><span class="s2">&quot;===t.subtype||&quot;</span><span class="nv">text</span><span class="s2">&quot;===t.type?t.value.toString():&quot;</span><span class="nv">operand</span><span class="s2">&quot;===t.type&amp;&amp;&quot;</span><span class="nv">range</span><span class="s2">&quot;===t.subtype?t.value.toString():(0===t.value.length?&quot;</span> <span class="s2">&quot;:t.value.toString()).split(&quot;</span> <span class="s2">&quot;).join(&quot;&quot;).toString(),&quot;</span><span class="nv">function</span><span class="s2">&quot;==typeof o){var l=o(p,t,n,r);if(p=l.tokenString,!l.useTemplate)return p}switch(t.type){case&quot;</span><span class="nv">function</span><span class="s2">&quot;:switch(t.value){case&quot;</span><span class="nv">ARRAY</span><span class="s2">&quot;:p=u(s(e.tmplFunctionStartArray),p,i,r);break;case&quot;</span><span class="nv">ARRAYROW</span><span class="s2">&quot;:p=u(s(e.tmplFunctionStartArrayRow),p,i,r);break;default:p=&quot;</span><span class="nv">start</span><span class="s2">&quot;===t.subtype.toString()?u(s(e.tmplFunctionStart),p,i,r):u(s(e.tmplFunctionStop),p,i,r)}break;case&quot;</span><span class="nv">operand</span><span class="s2">&quot;:switch(t.subtype.toString()){case&quot;</span><span class="nv">error</span><span class="s2">&quot;:p=u(s(e.tmplOperandError),p,i,r);break;case&quot;</span><span class="nv">range</span><span class="s2">&quot;:p=u(s(e.tmplOperandRange),p,i,r);break;case&quot;</span><span class="nv">logical</span><span class="s2">&quot;:p=u(s(e.tmplOperandLogical),p,i,r);break;case&quot;</span><span class="nv">number</span><span class="s2">&quot;:p=u(s(e.tmplOperandNumber),p,i,r);break;case&quot;</span><span class="nv">text</span><span class="s2">&quot;:p=u(s(e.tmplOperandText),p,i,r);break;case&quot;</span><span class="nv">argument</span><span class="s2">&quot;:p=u(s(e.tmplArgument),p,i,r)}break;case&quot;</span><span class="nv">operator-infix</span><span class="s2">&quot;:p=u(s(e.tmplOperandOperatorInfix),p,i,r);break;case&quot;</span><span class="nv">logical</span><span class="s2">&quot;:p=u(s(e.tmplLogical),p,i,r);break;case&quot;</span><span class="nv">argument</span><span class="s2">&quot;:p=&quot;</span><span class="nv">argument</span><span class="s2">&quot;!==a.type?u(s(e.tmplArgument),p,i,r):u(s(&quot;</span><span class="o">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">tmplArgument</span><span class="p">),</span><span class="nx">p</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">r</span><span class="p">);</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;subexpression&quot;</span><span class="o">:</span><span class="nx">p</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="o">===</span><span class="nx">t</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">?</span><span class="nx">u</span><span class="p">(</span><span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">tmplSubexpressionStart</span><span class="p">),</span><span class="nx">p</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">r</span><span class="p">)</span><span class="o">:</span><span class="nx">u</span><span class="p">(</span><span class="nx">s</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">tmplSubexpressionStop</span><span class="p">),</span><span class="nx">p</span><span class="p">,</span><span class="nx">i</span><span class="p">,</span><span class="nx">r</span><span class="p">)}</span><span class="k">return</span> <span class="nx">p</span><span class="p">}</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="o">||</span><span class="p">{},</span><span class="nx">p</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">core</span><span class="p">,</span><span class="nx">u</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">formatStr</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">trim</span><span class="p">,</span><span class="nx">c</span><span class="o">=</span><span class="p">{},</span><span class="nx">d</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_NOOP</span><span class="o">=</span><span class="s2">&quot;noop&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_OPERAND</span><span class="o">=</span><span class="s2">&quot;operand&quot;</span><span class="p">,</span><span class="nx">f</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_FUNCTION</span><span class="o">=</span><span class="s2">&quot;function&quot;</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_SUBEXPR</span><span class="o">=</span><span class="s2">&quot;subexpression&quot;</span><span class="p">,</span><span class="nx">S</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_ARGUMENT</span><span class="o">=</span><span class="s2">&quot;argument&quot;</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_OP_PRE</span><span class="o">=</span><span class="s2">&quot;operator-prefix&quot;</span><span class="p">,</span><span class="nx">h</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_OP_IN</span><span class="o">=</span><span class="s2">&quot;operator-infix&quot;</span><span class="p">,</span><span class="nx">y</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_OP_POST</span><span class="o">=</span><span class="s2">&quot;operator-postfix&quot;</span><span class="p">,</span><span class="nx">T</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_WSPACE</span><span class="o">=</span><span class="s2">&quot;white-space&quot;</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_TYPE_UNKNOWN</span><span class="o">=</span><span class="s2">&quot;unknown&quot;</span><span class="p">,</span><span class="nx">O</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_START</span><span class="o">=</span><span class="s2">&quot;start&quot;</span><span class="p">,</span><span class="nx">k</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_STOP</span><span class="o">=</span><span class="s2">&quot;stop&quot;</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_TEXT</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="p">,</span><span class="nx">w</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_NUMBER</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="p">,</span><span class="nx">E</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_LOGICAL</span><span class="o">=</span><span class="s2">&quot;logical&quot;</span><span class="p">,</span><span class="nx">R</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_ERROR</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span><span class="nx">_</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_RANGE</span><span class="o">=</span><span class="s2">&quot;range&quot;</span><span class="p">,</span><span class="nx">A</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_MATH</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="p">,</span><span class="nx">U</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_CONCAT</span><span class="o">=</span><span class="s2">&quot;concatenate&quot;</span><span class="p">,</span><span class="nx">F</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_INTERSECT</span><span class="o">=</span><span class="s2">&quot;intersect&quot;</span><span class="p">,</span><span class="nx">P</span><span class="o">=</span><span class="nx">c</span><span class="p">.</span><span class="nx">TOK_SUBTYPE_UNION</span><span class="o">=</span><span class="s2">&quot;union&quot;</span><span class="p">;</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">isEu</span><span class="o">=</span><span class="s2">&quot;boolean&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">isEu</span><span class="o">&amp;&amp;</span><span class="nx">t</span><span class="p">.</span><span class="nx">excelFormulaUtilities</span><span class="p">.</span><span class="nx">isEu</span><span class="p">;</span><span class="kd">var</span> <span class="nx">C</span><span class="o">=</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">parseFormula</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">,</span><span class="nx">e</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">n</span><span class="p">;</span><span class="nx">e</span><span class="o">+=</span><span class="mf">1</span><span class="p">)</span><span class="nx">t</span><span class="o">+=</span><span class="s2">&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&quot;</span><span class="p">;</span><span class="k">return</span> <span class="nx">t</span><span class="p">},</span><span class="nx">i</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span><span class="nx">a</span><span class="o">=</span><span class="nx">i</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="nx">o</span><span class="p">(</span><span class="nx">a</span><span class="p">),</span><span class="nx">p</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;table cellspacing=&#39;0&#39; style=&#39;border-top: 1px #cecece solid; margin-top: 5px; margin-bottom: 5px&#39;&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39; style=&#39;font-weight: bold; width: 50px&#39;&gt;index&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39; style=&#39;font-weight: bold; width: 125px&#39;&gt;type&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39; style=&#39;font-weight: bold; width: 125px&#39;&gt;subtype&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39; style=&#39;font-weight: bold; width: 150px&#39;&gt;token&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39; style=&#39;font-weight: bold; width: 300px&#39;&gt;token tree&lt;/td&gt;&lt;/tr&gt;&quot;</span><span class="p">;</span><span class="nx">s</span><span class="p">.</span><span class="nx">moveNext</span><span class="p">();){</span><span class="kd">var</span> <span class="nx">u</span><span class="o">=</span><span class="nx">s</span><span class="p">.</span><span class="nx">current</span><span class="p">();</span><span class="nx">u</span><span class="p">.</span><span class="nx">subtype</span><span class="o">===</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">n</span><span class="o">-=</span><span class="nx">n</span><span class="o">&gt;</span><span class="mf">0</span><span class="o">?</span><span class="mf">1</span><span class="o">:</span><span class="mf">0</span><span class="p">),</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;tr&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39;&gt;&quot;</span><span class="o">+</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">index</span><span class="o">+</span><span class="mf">1</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39;&gt;&quot;</span><span class="o">+</span><span class="nx">u</span><span class="p">.</span><span class="nx">type</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39;&gt;&quot;</span><span class="o">+</span><span class="p">(</span><span class="mf">0</span><span class="o">===</span><span class="nx">u</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="o">:</span><span class="nx">u</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39;&gt;&quot;</span><span class="o">+</span><span class="p">(</span><span class="mf">0</span><span class="o">===</span><span class="nx">u</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="o">:</span><span class="nx">u</span><span class="p">.</span><span class="nx">value</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;td class=&#39;token&#39;&gt;&quot;</span><span class="o">+</span><span class="nx">r</span><span class="p">()</span><span class="o">+</span><span class="p">(</span><span class="mf">0</span><span class="o">===</span><span class="nx">u</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="o">?</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="o">:</span><span class="nx">u</span><span class="p">.</span><span class="nx">value</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&lt;/td&gt;&quot;</span><span class="p">,</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;/tr&gt;&quot;</span><span class="p">,</span><span class="nx">u</span><span class="p">.</span><span class="nx">subtype</span><span class="o">===</span><span class="nx">O</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">n</span><span class="o">+=</span><span class="mf">1</span><span class="p">)}</span><span class="nx">p</span><span class="o">+=</span><span class="s2">&quot;&lt;/table&gt;&quot;</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">e</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">p</span><span class="p">,</span><span class="nx">i</span><span class="p">.</span><span class="nx">select</span><span class="p">(),</span><span class="nx">i</span><span class="p">.</span><span class="nx">focus</span><span class="p">()},</span><span class="nx">s</span><span class="p">.</span><span class="nx">toBase26</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="nx">t</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">abs</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span><span class="kd">var</span> <span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">r</span><span class="o">=!</span><span class="mf">1</span><span class="p">;</span><span class="k">do</span> <span class="nx">e</span><span class="o">=</span><span class="nx">t</span><span class="o">%</span><span class="mf">26</span><span class="p">,</span><span class="nx">r</span><span class="o">&amp;&amp;</span><span class="nx">t</span><span class="o">&lt;</span><span class="mf">25</span><span class="o">&amp;&amp;</span><span class="nx">e</span><span class="o">--</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">e</span><span class="o">+</span><span class="s2">&quot;A&quot;</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">))</span><span class="o">+</span><span class="nx">n</span><span class="p">,</span><span class="nx">t</span><span class="o">=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nx">t</span><span class="o">-</span><span class="nx">e</span><span class="p">)</span><span class="o">/</span><span class="mf">26</span><span class="p">),</span><span class="nx">r</span><span class="o">=!</span><span class="mf">0</span><span class="p">;</span><span class="k">while</span><span class="p">(</span><span class="nx">t</span><span class="o">&gt;</span><span class="mf">0</span><span class="p">);</span><span class="k">return</span> <span class="nx">n</span><span class="p">}),</span><span class="nx">N</span><span class="o">=</span><span class="nx">s</span><span class="p">.</span><span class="nx">fromBase26</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="nx">t</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">();</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="k">if</span><span class="p">(</span><span class="kc">null</span><span class="o">!==</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="s2">&quot;undefined&quot;</span><span class="o">!=</span><span class="ow">typeof</span> <span class="nx">t</span><span class="o">&amp;&amp;</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="o">&gt;</span><span class="mf">0</span><span class="p">)</span><span class="k">for</span><span class="p">(;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">n</span><span class="o">++</span><span class="p">)</span><span class="nx">e</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">t</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="nx">n</span><span class="o">-</span><span class="mf">1</span><span class="p">)</span><span class="o">-</span><span class="s2">&quot;A&quot;</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">),</span><span class="nx">r</span><span class="o">+=</span><span class="nb">Math</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="mf">26</span><span class="p">,</span><span class="nx">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="nx">e</span><span class="o">+</span><span class="mf">1</span><span class="p">);</span><span class="k">return</span> <span class="nx">r</span><span class="o">-</span><span class="mf">1</span><span class="p">},</span><span class="nx">Y</span><span class="o">=</span><span class="nx">s</span><span class="p">.</span><span class="nx">formatFormula</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">e</span><span class="p">){</span><span class="nx">t</span><span class="o">=</span><span class="nx">t</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\s*=\s+/</span><span class="p">,</span><span class="s2">&quot;=&quot;</span><span class="p">);</span><span class="kd">var</span> <span class="nx">n</span><span class="o">=!</span><span class="mf">0</span><span class="p">,</span><span class="nx">r</span><span class="o">=</span><span class="p">{</span><span class="nx">tmplFunctionStart</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">(\n&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStop</span><span class="o">:</span><span class="s2">&quot;\n</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">)&quot;</span><span class="p">,</span><span class="nx">tmplOperandError</span><span class="o">:</span><span class="s2">&quot; </span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandRange</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplLogical</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}{{</span><span class="nv">autolinebreak</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandLogical</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandNumber</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandText</span><span class="o">:</span><span class="s1">&#39;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s1">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s1">&quot;&#39;</span><span class="p">,</span><span class="nx">tmplArgument</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">\n&quot;</span><span class="p">,</span><span class="nx">tmplOperandOperatorInfix</span><span class="o">:</span><span class="s2">&quot; </span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}{{</span><span class="nv">autolinebreak</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStartArray</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStartArrayRow</span><span class="o">:</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStopArrayRow</span><span class="o">:</span><span class="s2">&quot;}&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStopArray</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStart</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s2">(\n&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStop</span><span class="o">:</span><span class="s2">&quot;\n)&quot;</span><span class="p">,</span><span class="nx">tmplIndentTab</span><span class="o">:</span><span class="s2">&quot;\t&quot;</span><span class="p">,</span><span class="nx">tmplIndentSpace</span><span class="o">:</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nx">autoLineBreak</span><span class="o">:</span><span class="s2">&quot;TOK_TYPE_FUNCTION | TOK_TYPE_ARGUMENT | TOK_SUBTYPE_LOGICAL | TOK_TYPE_OP_IN &quot;</span><span class="p">,</span><span class="nx">newLine</span><span class="o">:</span><span class="s2">&quot;\n&quot;</span><span class="p">,</span><span class="nx">customTokenRender</span><span class="o">:</span><span class="kc">null</span><span class="p">,</span><span class="nx">prefix</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">postfix</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">};</span><span class="nx">e</span><span class="o">=</span><span class="nx">e</span><span class="o">?</span><span class="nx">p</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="o">!</span><span class="mf">0</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">e</span><span class="p">)</span><span class="o">:</span><span class="nx">r</span><span class="p">;</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mf">0</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="kd">function</span><span class="p">(){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">t</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">i</span><span class="p">;</span><span class="nx">n</span><span class="o">+=</span><span class="mf">1</span><span class="p">)</span><span class="nx">t</span><span class="o">+=</span><span class="nx">e</span><span class="p">.</span><span class="nx">tmplIndentTab</span><span class="p">;</span><span class="k">return</span> <span class="nx">t</span><span class="p">},</span><span class="nx">u</span><span class="o">=</span><span class="nx">o</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span><span class="nx">d</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">g</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">autoLineBreak</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\s/gi</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">),</span><span class="nx">f</span><span class="o">=!</span><span class="mf">0</span><span class="p">,</span><span class="nx">m</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="mf">0</span><span class="p">;</span><span class="nx">e</span><span class="o">&lt;</span><span class="nx">g</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span><span class="nx">e</span><span class="o">+=</span><span class="mf">1</span><span class="p">)</span><span class="k">if</span><span class="p">(</span><span class="kc">null</span><span class="o">!==</span><span class="nx">t</span><span class="o">&amp;&amp;</span><span class="s2">&quot;undefined&quot;</span><span class="o">!=</span><span class="ow">typeof</span> <span class="nx">t</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">g</span><span class="p">[</span><span class="nx">e</span><span class="p">]]</span><span class="o">===</span><span class="nx">t</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">||</span><span class="nx">c</span><span class="p">[</span><span class="nx">g</span><span class="p">[</span><span class="nx">e</span><span class="p">]]</span><span class="o">===</span><span class="nx">t</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span><span class="k">return</span><span class="o">!</span><span class="mf">0</span><span class="p">;</span><span class="k">return</span><span class="o">!</span><span class="mf">1</span><span class="p">},</span><span class="nx">S</span><span class="o">=</span><span class="kc">null</span><span class="p">;</span><span class="nx">u</span><span class="p">.</span><span class="nx">moveNext</span><span class="p">();){</span><span class="kd">var</span> <span class="nx">b</span><span class="o">=</span><span class="nx">u</span><span class="p">.</span><span class="nx">current</span><span class="p">(),</span><span class="nx">h</span><span class="o">=</span><span class="nx">u</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span><span class="nx">b</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">===</span><span class="nx">k</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">-=</span><span class="nx">i</span><span class="o">&gt;</span><span class="mf">0</span><span class="o">?</span><span class="mf">1</span><span class="o">:</span><span class="mf">0</span><span class="p">);</span><span class="kd">var</span> <span class="nx">y</span><span class="o">=</span><span class="p">(</span><span class="ow">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;^&quot;</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">newLine</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">),</span><span class="ow">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">newLine</span><span class="o">+</span><span class="s2">&quot;$&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)),</span><span class="nx">T</span><span class="o">=</span><span class="nx">m</span><span class="p">(</span><span class="nx">h</span><span class="p">),</span><span class="nx">x</span><span class="o">=</span><span class="nx">f</span><span class="p">,</span><span class="nx">v</span><span class="o">=</span><span class="nx">x</span><span class="o">?</span><span class="nx">s</span><span class="p">()</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">tmplIndentSpace</span><span class="p">,</span><span class="nx">w</span><span class="o">=</span><span class="nx">T</span><span class="o">?</span><span class="nx">e</span><span class="p">.</span><span class="nx">newLine</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="nx">d</span><span class="o">+=</span><span class="nx">a</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">e</span><span class="p">,</span><span class="nx">v</span><span class="p">,</span><span class="nx">w</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nx">customTokenRender</span><span class="p">,</span><span class="nx">S</span><span class="p">),</span><span class="nx">b</span><span class="p">.</span><span class="nx">subtype</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span><span class="o">===</span><span class="nx">O</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">i</span><span class="o">+=</span><span class="mf">1</span><span class="p">),</span><span class="nx">f</span><span class="o">=</span><span class="nx">T</span><span class="o">||</span><span class="nx">y</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">d</span><span class="p">),</span><span class="nx">n</span><span class="o">=!</span><span class="mf">1</span><span class="p">,</span><span class="nx">S</span><span class="o">=</span><span class="nx">b</span><span class="p">}</span><span class="k">return</span> <span class="nx">d</span><span class="o">=</span><span class="nx">e</span><span class="p">.</span><span class="nx">prefix</span><span class="o">+</span><span class="nx">l</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span><span class="o">+</span><span class="nx">e</span><span class="p">.</span><span class="nx">postfix</span><span class="p">},</span><span class="nx">K</span><span class="o">=</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">formatFormulaHTML</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">{</span><span class="nx">tmplFunctionStart</span><span class="o">:</span><span class="s1">&#39;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s1">&lt;span class=&quot;function&quot;&gt;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s1">&lt;/span&gt;&lt;span class=&quot;function_start&quot;&gt;(&lt;/span&gt;&lt;br /&gt;&#39;</span><span class="p">,</span><span class="nx">tmplFunctionStop</span><span class="o">:</span><span class="s1">&#39;&lt;br /&gt;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s1">&lt;span class=&quot;function_stop&quot;&gt;)&lt;/span&gt;&#39;</span><span class="p">,</span><span class="nx">tmplOperandText</span><span class="o">:</span><span class="s1">&#39;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s1">&lt;span class=&quot;quote_mark&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;text&quot;&gt;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s1">&lt;/span&gt;&lt;span class=&quot;quote_mark&quot;&gt;&quot;&lt;/span&gt;&#39;</span><span class="p">,</span><span class="nx">tmplArgument</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&lt;br /&gt;&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStart</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">autoindent</span><span class="cp">}}</span><span class="s2">(&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStop</span><span class="o">:</span><span class="s2">&quot; )&quot;</span><span class="p">,</span><span class="nx">tmplIndentTab</span><span class="o">:</span><span class="s1">&#39;&lt;span class=&quot;tabbed&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&#39;</span><span class="p">,</span><span class="nx">tmplIndentSpace</span><span class="o">:</span><span class="s2">&quot;&amp;nbsp;&quot;</span><span class="p">,</span><span class="nx">newLine</span><span class="o">:</span><span class="s2">&quot;&lt;br /&gt;&quot;</span><span class="p">,</span><span class="nx">autoLineBreak</span><span class="o">:</span><span class="s2">&quot;TOK_TYPE_FUNCTION | TOK_TYPE_ARGUMENT | TOK_SUBTYPE_LOGICAL | TOK_TYPE_OP_IN &quot;</span><span class="p">,</span><span class="nx">trim</span><span class="o">:!</span><span class="mf">0</span><span class="p">,</span><span class="nx">prefix</span><span class="o">:</span><span class="s2">&quot;=&quot;</span><span class="p">,</span><span class="nx">customTokenRender</span><span class="o">:</span><span class="kc">null</span><span class="p">};</span><span class="k">return</span> <span class="nx">Y</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">e</span><span class="p">)},</span><span class="nx">s</span><span class="p">.</span><span class="nx">formula2CSharp</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="kd">var</span> <span class="nx">e</span><span class="o">=</span><span class="p">[],</span><span class="nx">n</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">r</span><span class="p">,</span><span class="nx">o</span><span class="p">){</span><span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">s</span><span class="o">=</span><span class="nx">t</span><span class="p">,</span><span class="nx">p</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;=&quot;</span><span class="o">:</span><span class="s2">&quot;==&quot;</span><span class="p">,</span><span class="s2">&quot;&lt;&gt;&quot;</span><span class="o">:</span><span class="s2">&quot;!=&quot;</span><span class="p">,</span><span class="nx">MIN</span><span class="o">:</span><span class="s2">&quot;Math.min&quot;</span><span class="p">,</span><span class="nx">MAX</span><span class="o">:</span><span class="s2">&quot;Math.max&quot;</span><span class="p">,</span><span class="nx">ABS</span><span class="o">:</span><span class="s2">&quot;Math.abs&quot;</span><span class="p">,</span><span class="nx">SUM</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">IF</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;&quot;</span><span class="o">:</span><span class="s2">&quot;+&quot;</span><span class="p">,</span><span class="nx">AND</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">OR</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="nx">u</span><span class="o">=</span><span class="nx">e</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mf">1</span><span class="p">],</span><span class="nx">l</span><span class="o">=!</span><span class="mf">1</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">toString</span><span class="p">()){</span><span class="k">case</span> <span class="nx">f</span><span class="o">:</span><span class="k">switch</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">subtype</span><span class="p">){</span><span class="k">case</span> <span class="nx">O</span><span class="o">:</span><span class="nx">e</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">name</span><span class="o">:</span><span class="nx">s</span><span class="p">,</span><span class="nx">argumentNumber</span><span class="o">:</span><span class="mf">0</span><span class="p">}),</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">?</span><span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">:</span><span class="nx">s</span><span class="p">,</span><span class="nx">l</span><span class="o">=!</span><span class="mf">0</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span> <span class="nx">k</span><span class="o">:</span><span class="k">switch</span><span class="p">(</span><span class="nx">l</span><span class="o">=!</span><span class="mf">0</span><span class="p">,</span><span class="nx">u</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">case</span><span class="s2">&quot;if&quot;</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="nx">l</span><span class="o">=!</span><span class="mf">1</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">?</span><span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">:</span><span class="nx">s</span><span class="p">}</span><span class="nx">e</span><span class="p">.</span><span class="nx">pop</span><span class="p">()}</span><span class="k">break</span><span class="p">;</span><span class="k">case</span> <span class="nx">S</span><span class="o">:</span><span class="k">switch</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">case</span><span class="s2">&quot;if&quot;</span><span class="o">:</span><span class="k">switch</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">argumentNumber</span><span class="p">){</span><span class="k">case</span> <span class="mf">0</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span> <span class="mf">1</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">}</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;sum&quot;</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;and&quot;</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;or&quot;</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;||&quot;</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">?</span><span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">:</span><span class="nx">s</span><span class="p">,</span><span class="nx">l</span><span class="o">=!</span><span class="mf">0</span><span class="p">}</span><span class="nx">u</span><span class="p">.</span><span class="nx">argumentNumber</span><span class="o">+=</span><span class="mf">1</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span> <span class="nx">g</span><span class="o">:</span><span class="k">switch</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">subtype</span><span class="p">){</span><span class="k">case</span> <span class="nx">_</span><span class="o">:</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">u</span><span class="p">)</span><span class="k">break</span><span class="p">;</span><span class="k">switch</span><span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()){</span><span class="k">case</span><span class="s2">&quot;sum&quot;</span><span class="o">:</span><span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;gi&quot;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="s2">&quot;+&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">outStr</span><span class="o">=</span><span class="nx">s</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;and&quot;</span><span class="o">:</span><span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;gi&quot;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="s2">&quot;&amp;&amp;&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">outStr</span><span class="o">=</span><span class="nx">s</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">case</span><span class="s2">&quot;or&quot;</span><span class="o">:</span><span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;gi&quot;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="o">?</span><span class="nx">a</span><span class="o">=</span><span class="nx">i</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="s2">&quot;||&quot;</span><span class="p">)</span><span class="o">:</span><span class="nx">outStr</span><span class="o">=</span><span class="nx">s</span><span class="p">;</span><span class="k">break</span><span class="p">;</span><span class="k">default</span><span class="o">:</span><span class="nx">a</span><span class="o">=</span><span class="nb">RegExp</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="s2">&quot;gi&quot;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="o">?</span><span class="s2">&quot;[&quot;</span><span class="o">+</span><span class="nx">i</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;]&quot;</span><span class="o">:</span><span class="nx">s</span><span class="p">}}</span><span class="k">default</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="o">===</span><span class="nx">a</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">a</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="o">==</span><span class="ow">typeof</span> <span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">?</span><span class="nx">p</span><span class="p">[</span><span class="nx">s</span><span class="p">.</span><span class="nx">toUpperCase</span><span class="p">()]</span><span class="o">:</span><span class="nx">s</span><span class="p">),</span><span class="nx">l</span><span class="o">=!</span><span class="mf">0</span><span class="p">}</span><span class="k">return</span><span class="p">{</span><span class="nx">tokenString</span><span class="o">:</span><span class="nx">a</span><span class="p">,</span><span class="nx">useTemplate</span><span class="o">:</span><span class="nx">l</span><span class="p">}},</span><span class="nx">r</span><span class="o">=</span><span class="nx">Y</span><span class="p">(</span><span class="nx">t</span><span class="p">,{</span><span class="nx">tmplFunctionStart</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">(&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStop</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">)&quot;</span><span class="p">,</span><span class="nx">tmplOperandError</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandRange</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandLogical</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandNumber</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandText</span><span class="o">:</span><span class="s1">&#39;&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s1">&quot;&#39;</span><span class="p">,</span><span class="nx">tmplArgument</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplOperandOperatorInfix</span><span class="o">:</span><span class="s2">&quot;</span><span class="cp">{{</span><span class="nv">token</span><span class="cp">}}</span><span class="s2">&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStartArray</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStartArrayRow</span><span class="o">:</span><span class="s2">&quot;{&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStopArrayRow</span><span class="o">:</span><span class="s2">&quot;}&quot;</span><span class="p">,</span><span class="nx">tmplFunctionStopArray</span><span class="o">:</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStart</span><span class="o">:</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="nx">tmplSubexpressionStop</span><span class="o">:</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="nx">tmplIndentTab</span><span class="o">:</span><span class="s2">&quot;\t&quot;</span><span class="p">,</span><span class="nx">tmplIndentSpace</span><span class="o">:</span><span class="s2">&quot; &quot;</span><span class="p">,</span><span class="nx">autoLineBreak</span><span class="o">:</span><span class="s2">&quot;TOK_SUBTYPE_STOP | TOK_SUBTYPE_START | TOK_TYPE_ARGUMENT&quot;</span><span class="p">,</span><span class="nx">trim</span><span class="o">:!</span><span class="mf">0</span><span class="p">,</span><span class="nx">customTokenRender</span><span class="o">:</span><span class="nx">n</span><span class="p">});</span><span class="k">return</span> <span class="nx">r</span><span class="p">});</span><span class="nx">s</span><span class="p">.</span><span class="nx">formula2JavaScript</span><span class="o">=</span><span class="kd">function</span><span class="p">(</span><span class="nx">t</span><span class="p">){</span><span class="k">return</span> <span class="nx">K</span><span class="p">(</span><span class="nx">t</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="s2">&quot;==&quot;</span><span class="p">,</span><span class="s2">&quot;===&quot;</span><span class="p">)};</span><span class="nx">s</span><span class="p">.</span><span class="nx">getTokens</span><span class="o">=</span><span class="nx">o</span><span class="p">}(</span><span class="nb">window</span><span class="o">||</span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="o">||</span><span class="p">{});</span>
</pre></div>
</body>
</html>
